<!DOCTYPE html>
<html>
<head>
    <title>ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë§ˆë¦¬ì˜¤ ì–´ë“œë²¤ì²˜</title>
    
    <!-- Google Analytics -->
    <script src="../../analytics.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Comic Sans MS', cursive;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            text-align: center;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        h1 {
            font-size: 3rem;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            margin-bottom: 20px;
            animation: jump 2s ease-in-out infinite;
        }
        
        @keyframes jump {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin: 20px auto;
            max-width: 900px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
        }
        
        canvas {
            border: 5px solid #fff;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            background: linear-gradient(180deg, #87CEEB 0%, #98FB98 100%);
        }
        
        .game-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .info-box {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .controls {
            margin: 20px 0;
        }
        
        button {
            background: linear-gradient(45deg, #00b894, #00a085);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(5px);
        }
        
        .level-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            display: none;
            z-index: 100;
            border: 3px solid #00b894;
        }
        
        .mobile-controls {
            display: none;
            margin: 20px 0;
            gap: 10px;
            justify-content: center;
        }
        
        .mobile-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 1.2rem;
            cursor: pointer;
            user-select: none;
        }
        
        .mobile-btn:active {
            background: rgba(255, 255, 255, 0.4);
        }
        
        @media (max-width: 768px) {
            .mobile-controls {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <h1>ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë§ˆë¦¬ì˜¤ ì–´ë“œë²¤ì²˜ ğŸ…</h1>
    
    <div class="instructions">
        <p><strong>ğŸ® ì¡°ì‘ë²•:</strong></p>
        <p>â† â†’ : ì¢Œìš° ì´ë™ | ìŠ¤í˜ì´ìŠ¤ë°” : ì í”„ | â†“ : ì•„ë˜ë¡œ ì´ë™</p>
        <p><strong>ğŸ¯ ëª©í‘œ:</strong> ì½”ì¸ì„ ëª¨ìœ¼ê³  ì ì„ í”¼í•´ ê³¨ì— ë„ë‹¬í•˜ì„¸ìš”!</p>
        <p><strong>âš ï¸ ì£¼ì˜:</strong> ì ì—ê²Œ ë‹¿ê±°ë‚˜ êµ¬ë©ì— ë–¨ì–´ì§€ë©´ ê²Œì„ ì˜¤ë²„!</p>
    </div>
    
    <div class="game-container">
        <div class="level-info" id="levelInfo">ë ˆë²¨ 1</div>
        
        <div class="game-info">
            <div class="info-box">ì ìˆ˜: <span id="score">0</span></div>
            <div class="info-box">ì½”ì¸: <span id="coins">0</span></div>
            <div class="info-box">ìƒëª…: <span id="lives">3</span></div>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="controls">
            <button onclick="startGame()">ğŸ® ê²Œì„ ì‹œì‘</button>
            <button onclick="pauseGame()">â¸ï¸ ì¼ì‹œì •ì§€</button>
            <button onclick="resetGame()">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
        </div>
        
        <div class="mobile-controls">
            <div class="mobile-btn" id="leftBtn">â†</div>
            <div class="mobile-btn" id="jumpBtn">ì í”„</div>
            <div class="mobile-btn" id="rightBtn">â†’</div>
        </div>
        
        <div class="game-over" id="gameOver">
            <h2 id="gameOverTitle">ğŸ‰ ë ˆë²¨ í´ë¦¬ì–´!</h2>
            <p>ìµœì¢… ì ìˆ˜: <span id="finalScore">0</span></p>
            <p>ìˆ˜ì§‘í•œ ì½”ì¸: <span id="finalCoins">0</span></p>
            <button onclick="nextLevel()">ë‹¤ìŒ ë ˆë²¨</button>
            <button onclick="resetGame()">ì²˜ìŒë¶€í„°</button>
        </div>
    </div>

    <script>
        // ìº”ë²„ìŠ¤ ì„¤ì •
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // ê²Œì„ ìƒíƒœ
        let gameRunning = false;
        let gamePaused = false;
        let currentLevel = 1;
        let score = 0;
        let coins = 0;
        let lives = 3;

        // í”Œë ˆì´ì–´ ì„¤ì •
        const player = {
            x: 50,
            y: 400,
            width: 30,
            height: 40,
            velocityX: 0,
            velocityY: 0,
            speed: 5,
            jumpPower: -15,
            onGround: false,
            direction: 1 // 1: ì˜¤ë¥¸ìª½, -1: ì™¼ìª½
        };

        // ê²Œì„ ê°ì²´ë“¤
        let platforms = [];
        let coinItems = [];
        let enemies = [];
        let particles = [];
        let camera = { x: 0, y: 0 };

        // ë ˆë²¨ ë°ì´í„°
        const levels = [
            {
                platforms: [
                    {x: 0, y: 550, width: 200, height: 50},
                    {x: 300, y: 450, width: 150, height: 20},
                    {x: 500, y: 350, width: 100, height: 20},
                    {x: 650, y: 250, width: 150, height: 20},
                    {x: 850, y: 400, width: 200, height: 20},
                    {x: 1100, y: 300, width: 100, height: 20},
                    {x: 1250, y: 500, width: 200, height: 50}
                ],
                coins: [
                    {x: 320, y: 400}, {x: 520, y: 300}, {x: 670, y: 200},
                    {x: 870, y: 350}, {x: 1120, y: 250}
                ],
                enemies: [
                    {x: 320, y: 410, width: 25, height: 25, speed: 1, direction: 1, platform: 1},
                    {x: 870, y: 360, width: 25, height: 25, speed: 1.5, direction: -1, platform: 4}
                ],
                goal: {x: 1300, y: 450}
            },
            {
                platforms: [
                    {x: 0, y: 550, width: 150, height: 50},
                    {x: 200, y: 480, width: 100, height: 20},
                    {x: 350, y: 400, width: 80, height: 20},
                    {x: 480, y: 320, width: 100, height: 20},
                    {x: 630, y: 240, width: 80, height: 20},
                    {x: 750, y: 350, width: 120, height: 20},
                    {x: 920, y: 450, width: 100, height: 20},
                    {x: 1070, y: 380, width: 150, height: 20},
                    {x: 1270, y: 500, width: 200, height: 50}
                ],
                coins: [
                    {x: 220, y: 430}, {x: 370, y: 350}, {x: 500, y: 270},
                    {x: 650, y: 190}, {x: 770, y: 300}, {x: 940, y: 400},
                    {x: 1090, y: 330}
                ],
                enemies: [
                    {x: 220, y: 440, width: 25, height: 25, speed: 1, direction: 1, platform: 1},
                    {x: 500, y: 280, width: 25, height: 25, speed: 1.2, direction: -1, platform: 3},
                    {x: 770, y: 310, width: 25, height: 25, speed: 0.8, direction: 1, platform: 5},
                    {x: 1090, y: 340, width: 25, height: 25, speed: 1.5, direction: -1, platform: 7}
                ],
                goal: {x: 1320, y: 450}
            }
        ];

        // íŒŒí‹°í´ í´ë˜ìŠ¤
        class Particle {
            constructor(x, y, color, type = 'normal') {
                this.x = x;
                this.y = y;
                this.dx = (Math.random() - 0.5) * 6;
                this.dy = (Math.random() - 0.5) * 6;
                this.color = color;
                this.life = 30;
                this.maxLife = 30;
                this.size = Math.random() * 4 + 2;
                this.type = type;
            }
            
            update() {
                this.x += this.dx;
                this.y += this.dy;
                this.life--;
                
                if (this.type === 'coin') {
                    this.dy -= 0.1; // ìœ„ë¡œ ì˜¬ë¼ê°
                } else {
                    this.dy += 0.2; // ì¤‘ë ¥
                }
                
                this.dx *= 0.98; // ê³µê¸° ì €í•­
            }
            
            draw() {
                const alpha = this.life / this.maxLife;
                ctx.globalAlpha = alpha;
                ctx.fillStyle = this.color;
                
                if (this.type === 'coin') {
                    ctx.beginPath();
                    ctx.arc(this.x - camera.x, this.y - camera.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                } else {
                    ctx.fillRect(this.x - camera.x, this.y - camera.y, this.size, this.size);
                }
                
                ctx.globalAlpha = 1;
            }
            
            isDead() {
                return this.life <= 0;
            }
        }

        // ë ˆë²¨ ë¡œë“œ
        function loadLevel(levelNum) {
            const level = levels[levelNum - 1];
            if (!level) return false;
            
            platforms = [...level.platforms];
            coinItems = [...level.coins];
            enemies = level.enemies.map(enemy => ({
                ...enemy,
                originalX: enemy.x,
                platformIndex: enemy.platform
            }));
            
            // í”Œë ˆì´ì–´ ì´ˆê¸° ìœ„ì¹˜
            player.x = 50;
            player.y = 400;
            player.velocityX = 0;
            player.velocityY = 0;
            
            // ì¹´ë©”ë¼ ì´ˆê¸°í™”
            camera.x = 0;
            camera.y = 0;
            
            particles = [];
            
            return true;
        }

        // ë°°ê²½ ê·¸ë¦¬ê¸°
        function drawBackground() {
            // í•˜ëŠ˜ ê·¸ë¼ë°ì´ì…˜
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(1, '#98FB98');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // êµ¬ë¦„
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            for (let i = 0; i < 5; i++) {
                const x = (i * 200 + 100 - camera.x * 0.3) % (canvas.width + 100);
                const y = 50 + i * 20;
                drawCloud(x, y, 40);
            }
        }

        // êµ¬ë¦„ ê·¸ë¦¬ê¸°
        function drawCloud(x, y, size) {
            ctx.beginPath();
            ctx.arc(x, y, size * 0.5, 0, Math.PI * 2);
            ctx.arc(x + size * 0.3, y, size * 0.7, 0, Math.PI * 2);
            ctx.arc(x + size * 0.6, y, size * 0.5, 0, Math.PI * 2);
            ctx.arc(x - size * 0.3, y, size * 0.6, 0, Math.PI * 2);
            ctx.fill();
        }

        // í”Œë«í¼ ê·¸ë¦¬ê¸°
        function drawPlatforms() {
            platforms.forEach(platform => {
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(
                    platform.x - camera.x, 
                    platform.y - camera.y, 
                    platform.width, 
                    platform.height
                );
                
                // í”Œë«í¼ í…Œë‘ë¦¬
                ctx.strokeStyle = '#654321';
                ctx.lineWidth = 2;
                ctx.strokeRect(
                    platform.x - camera.x, 
                    platform.y - camera.y, 
                    platform.width, 
                    platform.height
                );
            });
        }

        // ì½”ì¸ ê·¸ë¦¬ê¸°
        function drawCoins() {
            coinItems.forEach((coin, index) => {
                const time = Date.now() * 0.005;
                const bounce = Math.sin(time + index) * 5;
                
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(
                    coin.x - camera.x, 
                    coin.y - camera.y + bounce, 
                    15, 0, Math.PI * 2
                );
                ctx.fill();
                
                ctx.fillStyle = '#FFA500';
                ctx.beginPath();
                ctx.arc(
                    coin.x - camera.x, 
                    coin.y - camera.y + bounce, 
                    10, 0, Math.PI * 2
                );
                ctx.fill();
            });
        }

        // ì  ê·¸ë¦¬ê¸°
        function drawEnemies() {
            enemies.forEach(enemy => {
                ctx.fillStyle = '#FF4444';
                ctx.fillRect(
                    enemy.x - camera.x, 
                    enemy.y - camera.y, 
                    enemy.width, 
                    enemy.height
                );
                
                // ì  ëˆˆ
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(
                    enemy.x - camera.x + 5, 
                    enemy.y - camera.y + 5, 
                    4, 4
                );
                ctx.fillRect(
                    enemy.x - camera.x + 15, 
                    enemy.y - camera.y + 5, 
                    4, 4
                );
            });
        }

        // í”Œë ˆì´ì–´ ê·¸ë¦¬ê¸°
        function drawPlayer() {
            ctx.fillStyle = '#4169E1';
            ctx.fillRect(
                player.x - camera.x, 
                player.y - camera.y, 
                player.width, 
                player.height
            );
            
            // í”Œë ˆì´ì–´ ì–¼êµ´
            ctx.fillStyle = '#FFE4B5';
            ctx.fillRect(
                player.x - camera.x + 5, 
                player.y - camera.y + 5, 
                player.width - 10, 
                15
            );
            
            // ëˆˆ
            ctx.fillStyle = '#000';
            const eyeOffset = player.direction > 0 ? 0 : 5;
            ctx.fillRect(
                player.x - camera.x + 8 + eyeOffset, 
                player.y - camera.y + 8, 
                3, 3
            );
            ctx.fillRect(
                player.x - camera.x + 15 + eyeOffset, 
                player.y - camera.y + 8, 
                3, 3
            );
        }

        // ê³¨ ê·¸ë¦¬ê¸°
        function drawGoal() {
            const level = levels[currentLevel - 1];
            if (!level) return;
            
            const goal = level.goal;
            
            // ê³¨ ê¹ƒë°œ
            ctx.fillStyle = '#FF1493';
            ctx.fillRect(goal.x - camera.x, goal.y - camera.y, 30, 50);
            
            // ê¹ƒë°œ ë§‰ëŒ€
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(goal.x - camera.x + 25, goal.y - camera.y, 5, 70);
            
            // ê¹ƒë°œ ì• ë‹ˆë©”ì´ì…˜
            const time = Date.now() * 0.01;
            ctx.fillStyle = '#FF69B4';
            ctx.fillRect(
                goal.x - camera.x + Math.sin(time) * 2, 
                goal.y - camera.y + 10, 
                20, 30
            );
        }

        // ì¶©ëŒ ê²€ì‚¬
        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }

        // í”Œë ˆì´ì–´ ì—…ë°ì´íŠ¸
        function updatePlayer() {
            // ì¤‘ë ¥ ì ìš©
            player.velocityY += 0.8;
            
            // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
            player.x += player.velocityX;
            player.y += player.velocityY;
            
            // í”Œë«í¼ ì¶©ëŒ ê²€ì‚¬
            player.onGround = false;
            
            platforms.forEach(platform => {
                if (checkCollision(player, platform)) {
                    // ìœ„ì—ì„œ ë–¨ì–´ì§€ëŠ” ê²½ìš°
                    if (player.velocityY > 0 && 
                        player.y < platform.y) {
                        player.y = platform.y - player.height;
                        player.velocityY = 0;
                        player.onGround = true;
                    }
                    // ì•„ë˜ì—ì„œ ì˜¬ë¼ê°€ëŠ” ê²½ìš°
                    else if (player.velocityY < 0 && 
                             player.y > platform.y) {
                        player.y = platform.y + platform.height;
                        player.velocityY = 0;
                    }
                    // ì˜†ì—ì„œ ì¶©ëŒí•˜ëŠ” ê²½ìš°
                    else if (player.velocityX > 0 && 
                             player.x < platform.x) {
                        player.x = platform.x - player.width;
                        player.velocityX = 0;
                    }
                    else if (player.velocityX < 0 && 
                             player.x > platform.x) {
                        player.x = platform.x + platform.width;
                        player.velocityX = 0;
                    }
                }
            });
            
            // í™”ë©´ ì•„ë˜ë¡œ ë–¨ì–´ì§€ë©´ ìƒëª… ê°ì†Œ
            if (player.y > canvas.height + 100) {
                loseLife();
            }
            
            // ë§ˆì°°
            player.velocityX *= 0.8;
        }

        // ì  ì—…ë°ì´íŠ¸
        function updateEnemies() {
            enemies.forEach(enemy => {
                enemy.x += enemy.speed * enemy.direction;
                
                // í”Œë«í¼ ê²½ê³„ì—ì„œ ë°©í–¥ ì „í™˜
                const platform = platforms[enemy.platformIndex];
                if (platform) {
                    if (enemy.x <= platform.x || 
                        enemy.x + enemy.width >= platform.x + platform.width) {
                        enemy.direction *= -1;
                    }
                }
                
                // í”Œë ˆì´ì–´ì™€ ì¶©ëŒ ê²€ì‚¬
                if (checkCollision(player, enemy)) {
                    loseLife();
                }
            });
        }

        // ì½”ì¸ ìˆ˜ì§‘ í™•ì¸
        function checkCoinCollection() {
            for (let i = coinItems.length - 1; i >= 0; i--) {
                const coin = coinItems[i];
                const coinRect = {x: coin.x - 15, y: coin.y - 15, width: 30, height: 30};
                
                if (checkCollision(player, coinRect)) {
                    // ì½”ì¸ ìˆ˜ì§‘
                    coins++;
                    score += 100;
                    
                    // íŒŒí‹°í´ íš¨ê³¼
                    for (let j = 0; j < 8; j++) {
                        particles.push(new Particle(coin.x, coin.y, '#FFD700', 'coin'));
                    }
                    
                    coinItems.splice(i, 1);
                }
            }
        }

        // ê³¨ ë„ë‹¬ í™•ì¸
        function checkGoal() {
            const level = levels[currentLevel - 1];
            if (!level) return;
            
            const goal = level.goal;
            const goalRect = {x: goal.x, y: goal.y, width: 30, height: 50};
            
            if (checkCollision(player, goalRect)) {
                levelComplete();
            }
        }

        // ì¹´ë©”ë¼ ì—…ë°ì´íŠ¸
        function updateCamera() {
            // í”Œë ˆì´ì–´ë¥¼ ì¤‘ì•™ì— ìœ ì§€
            camera.x = player.x - canvas.width / 2;
            camera.y = player.y - canvas.height / 2;
            
            // ì¹´ë©”ë¼ ê²½ê³„ ì œí•œ
            camera.x = Math.max(0, camera.x);
            camera.y = Math.max(-200, Math.min(0, camera.y));
        }

        // ìƒëª… ìƒê¸°
        function loseLife() {
            lives--;
            
            if (lives <= 0) {
                gameOver(false);
            } else {
                // í”Œë ˆì´ì–´ ìœ„ì¹˜ ë¦¬ì…‹
                player.x = 50;
                player.y = 400;
                player.velocityX = 0;
                player.velocityY = 0;
                
                // í­ë°œ íŒŒí‹°í´
                for (let i = 0; i < 15; i++) {
                    particles.push(new Particle(
                        player.x + player.width/2,
                        player.y + player.height/2,
                        '#FF4444'
                    ));
                }
            }
            
            updateDisplay();
        }

        // ë ˆë²¨ ì™„ë£Œ
        function levelComplete() {
            score += 500; // ë ˆë²¨ ì™„ë£Œ ë³´ë„ˆìŠ¤
            score += coins * 50; // ì½”ì¸ ë³´ë„ˆìŠ¤
            
            document.getElementById('gameOverTitle').textContent = 'ğŸ‰ ë ˆë²¨ í´ë¦¬ì–´!';
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalCoins').textContent = coins;
            document.getElementById('gameOver').style.display = 'block';
            
            gameRunning = false;
        }

        // ê²Œì„ ì˜¤ë²„
        function gameOver(victory) {
            gameRunning = false;
            
            if (!victory) {
                document.getElementById('gameOverTitle').textContent = 'ğŸ’¥ ê²Œì„ ì˜¤ë²„!';
                document.getElementById('finalScore').textContent = score;
                document.getElementById('finalCoins').textContent = coins;
                document.getElementById('gameOver').style.display = 'block';
            }
        }

        // ë‹¤ìŒ ë ˆë²¨
        function nextLevel() {
            currentLevel++;
            
            if (loadLevel(currentLevel)) {
                document.getElementById('gameOver').style.display = 'none';
                gameRunning = true;
                updateDisplay();
            } else {
                // ëª¨ë“  ë ˆë²¨ ì™„ë£Œ
                document.getElementById('gameOverTitle').textContent = 'ğŸ† ê²Œì„ ì™„ë£Œ!';
                document.getElementById('gameOver').style.display = 'block';
            }
        }

        // ê²Œì„ ì—…ë°ì´íŠ¸
        function update() {
            if (!gameRunning || gamePaused) return;
            
            updatePlayer();
            updateEnemies();
            checkCoinCollection();
            checkGoal();
            updateCamera();
            
            // íŒŒí‹°í´ ì—…ë°ì´íŠ¸
            particles.forEach(particle => particle.update());
            particles = particles.filter(particle => !particle.isDead());
        }

        // ê²Œì„ ê·¸ë¦¬ê¸°
        function draw() {
            drawBackground();
            drawPlatforms();
            drawCoins();
            drawEnemies();
            drawPlayer();
            drawGoal();
            
            // íŒŒí‹°í´ ê·¸ë¦¬ê¸°
            particles.forEach(particle => particle.draw());
        }

        // ê²Œì„ ë£¨í”„
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            document.getElementById('score').textContent = score;
            document.getElementById('coins').textContent = coins;
            document.getElementById('lives').textContent = lives;
            document.getElementById('levelInfo').textContent = `ë ˆë²¨ ${currentLevel}`;
        }

        // ê²Œì„ ì‹œì‘
        function startGame() {
            if (!gameRunning) {
                // ì•”í˜¸ í™•ì¸
                const password = prompt("ğŸ® ê²Œì„ì„ ì‹œì‘í•˜ë ¤ë©´ ì•”í˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
                if (password !== "ë¯¼ì¬ ì˜ˆë»") {
                    alert("âŒ ì˜ëª»ëœ ì•”í˜¸ì…ë‹ˆë‹¤! ê²Œì„ì„ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }
                
                alert("âœ… ì•”í˜¸ê°€ ë§ìŠµë‹ˆë‹¤! ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! ğŸ‰");
                gameRunning = true;
                gamePaused = false;
                document.getElementById('gameOver').style.display = 'none';
            }
        }

        // ê²Œì„ ì¼ì‹œì •ì§€
        function pauseGame() {
            if (gameRunning) {
                gamePaused = !gamePaused;
            }
        }

        // ê²Œì„ ë¦¬ì…‹
        function resetGame() {
            // ì•”í˜¸ í™•ì¸
            const password = prompt("ğŸ”„ ê²Œì„ì„ ë‹¤ì‹œ ì‹œì‘í•˜ë ¤ë©´ ì•”í˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
            if (password !== "ë¯¼ì¬ ì˜ˆë»") {
                alert("âŒ ì˜ëª»ëœ ì•”í˜¸ì…ë‹ˆë‹¤! ê²Œì„ì„ ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                return;
            }
            
            currentLevel = 1;
            score = 0;
            coins = 0;
            lives = 3;
            
            loadLevel(currentLevel);
            
            gameRunning = true;
            gamePaused = false;
            document.getElementById('gameOver').style.display = 'none';
            
            updateDisplay();
            
            alert("âœ… ê²Œì„ì´ ë‹¤ì‹œ ì‹œì‘ë©ë‹ˆë‹¤! ğŸ®");
        }

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
        let keys = {};
        
        document.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            
            if (e.code === 'Space') {
                e.preventDefault();
                if (player.onGround) {
                    player.velocityY = player.jumpPower;
                }
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.code] = false;
        });

        // í‚¤ ì…ë ¥ ì²˜ë¦¬
        function handleInput() {
            if (!gameRunning || gamePaused) return;
            
            if (keys['ArrowLeft'] || keys['KeyA']) {
                player.velocityX = -player.speed;
                player.direction = -1;
            }
            if (keys['ArrowRight'] || keys['KeyD']) {
                player.velocityX = player.speed;
                player.direction = 1;
            }
        }

        // ëª¨ë°”ì¼ ì»¨íŠ¸ë¡¤
        document.getElementById('leftBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys['ArrowLeft'] = true;
        });
        
        document.getElementById('leftBtn').addEventListener('touchend', (e) => {
            e.preventDefault();
            keys['ArrowLeft'] = false;
        });
        
        document.getElementById('rightBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys['ArrowRight'] = true;
        });
        
        document.getElementById('rightBtn').addEventListener('touchend', (e) => {
            e.preventDefault();
            keys['ArrowRight'] = false;
        });
        
        document.getElementById('jumpBtn').addEventListener('touchstart', (e) => {
            e.preventDefault();
            if (player.onGround) {
                player.velocityY = player.jumpPower;
            }
        });

        // ê²Œì„ ë£¨í”„ì— ì…ë ¥ ì²˜ë¦¬ ì¶”ê°€
        function gameLoopWithInput() {
            handleInput();
            update();
            draw();
            requestAnimationFrame(gameLoopWithInput);
        }

        // ì´ˆê¸°í™”
        loadLevel(currentLevel);
        updateDisplay();
        gameLoopWithInput();
        
        console.log('í”Œë«í¬ë¨¸ ê²Œì„ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
    </script>
</body>
</html>