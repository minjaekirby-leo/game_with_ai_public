<!DOCTYPE html>
<html>
<head>
    <title>ë‘ë”ì§€ ì¡ê¸° ê²Œì„</title>
    
    <!-- Google Analytics -->
    <script src="../../analytics.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Comic Sans MS', cursive;
            background: linear-gradient(135deg, #8BC34A 0%, #4CAF50 100%);
            color: white;
            text-align: center;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        h1 {
            font-size: 3rem;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            margin-bottom: 20px;
            animation: bounce 2s ease-in-out infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin: 20px auto;
            max-width: 600px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .game-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .info-box {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
            max-width: 450px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .hole {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #3E2723 0%, #1B0000 100%);
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            border: 5px solid #5D4037;
            box-shadow: inset 0 10px 20px rgba(0,0,0,0.8);
            transition: all 0.1s;
        }
        
        .hole:hover {
            transform: scale(1.05);
        }
        
        .mole {
            width: 80px;
            height: 80px;
            background: #8D6E63;
            border-radius: 50% 50% 40% 40%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, 100%);
            transition: transform 0.3s ease;
            cursor: pointer;
            border: 3px solid #5D4037;
        }
        
        .mole::before {
            content: '';
            position: absolute;
            width: 15px;
            height: 15px;
            background: #000;
            border-radius: 50%;
            top: 20px;
            left: 20px;
        }
        
        .mole::after {
            content: '';
            position: absolute;
            width: 15px;
            height: 15px;
            background: #000;
            border-radius: 50%;
            top: 20px;
            right: 20px;
        }
        
        .mole.up {
            transform: translate(-50%, -20%);
        }
        
        .mole.hit {
            background: #FF5722;
            animation: hit 0.3s ease;
        }
        
        @keyframes hit {
            0% { transform: translate(-50%, -20%) scale(1); }
            50% { transform: translate(-50%, -20%) scale(1.2); }
            100% { transform: translate(-50%, 100%) scale(1); }
        }
        
        .controls {
            margin: 20px 0;
        }
        
        button {
            background: linear-gradient(45deg, #FF6B35, #F7931E);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        button:disabled {
            background: #999;
            cursor: not-allowed;
            transform: none;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(5px);
        }
        
        .game-over {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            display: none;
            z-index: 100;
            border: 3px solid #FF6B35;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }
        
        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #FFD700;
            border-radius: 50%;
            pointer-events: none;
            animation: particle 1s ease-out forwards;
        }
        
        @keyframes particle {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(0) translateY(-50px);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ ë‘ë”ì§€ ì¡ê¸° ê²Œì„</h1>
    
    <div class="instructions">
        <p><strong>ğŸ® ê²Œì„ ë°©ë²•:</strong></p>
        <p>êµ¬ë©ì—ì„œ ë‚˜ì˜¤ëŠ” ë‘ë”ì§€ë¥¼ ë¹ ë¥´ê²Œ í´ë¦­í•˜ì„¸ìš”!</p>
        <p>ì‹œê°„ì´ ëë‚˜ê¸° ì „ì— ìµœëŒ€í•œ ë§ì€ ë‘ë”ì§€ë¥¼ ì¡ì•„ë³´ì„¸ìš”!</p>
    </div>
    
    <div class="game-container">
        <div class="game-info">
            <div class="info-box">ì ìˆ˜: <span id="score">0</span></div>
            <div class="info-box">ì‹œê°„: <span id="time">30</span>ì´ˆ</div>
            <div class="info-box">ìµœê³  ê¸°ë¡: <span id="bestScore">0</span></div>
        </div>
        
        <div class="controls">
            <button id="startBtn" onclick="startGame()">ğŸ® ê²Œì„ ì‹œì‘</button>
            <button onclick="resetGame()">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
        </div>
        
        <div class="game-board" id="gameBoard">
            <!-- êµ¬ë©ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
        </div>
    </div>
    
    <div class="game-over" id="gameOver">
        <h2>ğŸ‰ ê²Œì„ ì¢…ë£Œ!</h2>
        <p>ìµœì¢… ì ìˆ˜: <span id="finalScore">0</span></p>
        <p id="newRecord" style="display: none; color: #FFD700;">ğŸ† ìƒˆë¡œìš´ ê¸°ë¡!</p>
        <button onclick="resetGame()">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
    </div>

    <script>
        // ê²Œì„ ìƒíƒœ
        let gameRunning = false;
        let score = 0;
        let timeLeft = 30;
        let bestScore = localStorage.getItem('whackMoleBestScore') || 0;
        let gameTimer = null;
        let moleTimer = null;
        let activeMoles = [];

        // ê²Œì„ ì„¤ì •
        const GAME_TIME = 30;
        const MOLE_SHOW_TIME = 1500; // ë‘ë”ì§€ê°€ ë‚˜ì™€ìˆëŠ” ì‹œê°„
        const MOLE_SPAWN_INTERVAL = 800; // ë‘ë”ì§€ ìƒì„± ê°„ê²©

        // ê²Œì„ ë³´ë“œ ìƒì„±
        function createGameBoard() {
            const gameBoard = document.getElementById('gameBoard');
            gameBoard.innerHTML = '';
            
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.className = 'hole';
                hole.dataset.index = i;
                
                const mole = document.createElement('div');
                mole.className = 'mole';
                mole.addEventListener('click', hitMole);
                
                hole.appendChild(mole);
                gameBoard.appendChild(hole);
            }
        }

        // ë‘ë”ì§€ ìƒì„±
        function spawnMole() {
            if (!gameRunning) return;
            
            const holes = document.querySelectorAll('.hole');
            const availableHoles = Array.from(holes).filter(hole => 
                !hole.querySelector('.mole').classList.contains('up')
            );
            
            if (availableHoles.length === 0) return;
            
            const randomHole = availableHoles[Math.floor(Math.random() * availableHoles.length)];
            const mole = randomHole.querySelector('.mole');
            
            // ë‘ë”ì§€ ì˜¬ë¼ì˜¤ê¸°
            mole.classList.add('up');
            activeMoles.push(mole);
            
            // ì¼ì • ì‹œê°„ í›„ ë‘ë”ì§€ ë‚´ë ¤ê°€ê¸°
            setTimeout(() => {
                if (mole.classList.contains('up')) {
                    mole.classList.remove('up');
                    activeMoles = activeMoles.filter(m => m !== mole);
                }
            }, MOLE_SHOW_TIME);
        }

        // ë‘ë”ì§€ ë§ì¶”ê¸°
        function hitMole(event) {
            if (!gameRunning) return;
            
            const mole = event.target;
            if (!mole.classList.contains('up')) return;
            
            // ì ìˆ˜ ì¦ê°€
            score += 10;
            updateDisplay();
            
            // ë‘ë”ì§€ ë§ì¶˜ íš¨ê³¼
            mole.classList.add('hit');
            mole.classList.remove('up');
            activeMoles = activeMoles.filter(m => m !== mole);
            
            // íŒŒí‹°í´ íš¨ê³¼
            createParticles(event.clientX, event.clientY);
            
            // íš¨ê³¼ ì œê±°
            setTimeout(() => {
                mole.classList.remove('hit');
            }, 300);
        }

        // íŒŒí‹°í´ íš¨ê³¼ ìƒì„±
        function createParticles(x, y) {
            for (let i = 0; i < 8; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.transform = `rotate(${i * 45}deg)`;
                
                document.body.appendChild(particle);
                
                setTimeout(() => {
                    particle.remove();
                }, 1000);
            }
        }

        // ê²Œì„ ì‹œì‘
        function startGame() {
            if (gameRunning) return;
            
            gameRunning = true;
            score = 0;
            timeLeft = GAME_TIME;
            activeMoles = [];
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('gameOver').style.display = 'none';
            
            updateDisplay();
            
            // ê²Œì„ íƒ€ì´ë¨¸
            gameTimer = setInterval(() => {
                timeLeft--;
                updateDisplay();
                
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
            
            // ë‘ë”ì§€ ìƒì„± íƒ€ì´ë¨¸
            moleTimer = setInterval(spawnMole, MOLE_SPAWN_INTERVAL);
            
            // ì²« ë‘ë”ì§€ ì¦‰ì‹œ ìƒì„±
            setTimeout(spawnMole, 500);
        }

        // ê²Œì„ ì¢…ë£Œ
        function endGame() {
            gameRunning = false;
            
            clearInterval(gameTimer);
            clearInterval(moleTimer);
            
            // ëª¨ë“  ë‘ë”ì§€ ìˆ¨ê¸°ê¸°
            activeMoles.forEach(mole => {
                mole.classList.remove('up');
            });
            activeMoles = [];
            
            // ìµœê³  ê¸°ë¡ í™•ì¸
            let isNewRecord = false;
            if (score > bestScore) {
                bestScore = score;
                localStorage.setItem('whackMoleBestScore', bestScore);
                isNewRecord = true;
            }
            
            // ê²Œì„ ì˜¤ë²„ í™”ë©´ í‘œì‹œ
            document.getElementById('finalScore').textContent = score;
            document.getElementById('newRecord').style.display = isNewRecord ? 'block' : 'none';
            document.getElementById('gameOver').style.display = 'block';
            
            document.getElementById('startBtn').disabled = false;
            updateDisplay();
        }

        // ê²Œì„ ë¦¬ì…‹
        function resetGame() {
            gameRunning = false;
            
            if (gameTimer) clearInterval(gameTimer);
            if (moleTimer) clearInterval(moleTimer);
            
            score = 0;
            timeLeft = GAME_TIME;
            activeMoles = [];
            
            // ëª¨ë“  ë‘ë”ì§€ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.mole').forEach(mole => {
                mole.classList.remove('up', 'hit');
            });
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('gameOver').style.display = 'none';
            
            updateDisplay();
        }

        // ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            document.getElementById('score').textContent = score;
            document.getElementById('time').textContent = timeLeft;
            document.getElementById('bestScore').textContent = bestScore;
        }

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                if (!gameRunning) {
                    startGame();
                }
            }
        });

        // ì´ˆê¸°í™”
        createGameBoard();
        updateDisplay();
        
        console.log('ë‘ë”ì§€ ì¡ê¸° ê²Œì„ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
    </script>
</body>
</html>