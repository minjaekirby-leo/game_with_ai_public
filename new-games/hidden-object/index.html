<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” ìˆ¨ì€ ê·¸ë¦¼ ì°¾ê¸°</title>
    
    <!-- Google Analytics -->
    <script src="../../analytics.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #2E8B57, #228B22);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
        }
        
        .game-container {
            text-align: center;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #32CD32;
            max-width: 1000px;
        }
        
        .game-area {
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        
        canvas {
            border: 3px solid #228B22;
            border-radius: 10px;
            background: #F5F5DC;
            cursor: crosshair;
        }
        
        .sidebar {
            width: 200px;
            background: rgba(50, 205, 50, 0.2);
            border-radius: 10px;
            padding: 15px;
        }
        
        .ui {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(50, 205, 50, 0.8);
            padding: 8px 15px;
            border-radius: 20px;
            margin: 5px;
            font-weight: bold;
        }
        
        .objects-list {
            text-align: left;
        }
        
        .object-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            margin: 5px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            font-size: 16px;
        }
        
        .object-item.found {
            background: rgba(0,255,0,0.3);
            text-decoration: line-through;
            opacity: 0.7;
        }
        
        .hint-btn {
            background: #FFD700;
            color: #333;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }
        
        .hint-btn:hover {
            background: #FFA500;
        }
        
        .hint-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .controls {
            margin: 15px 0;
        }
        
        .control-btn {
            background: #32CD32;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: #228B22;
            transform: scale(1.05);
        }
        
        .difficulty-selector {
            margin: 10px 0;
        }
        
        .difficulty-btn {
            background: #4169E1;
            color: white;
            border: none;
            padding: 8px 15px;
            margin: 0 5px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .difficulty-btn.active {
            background: #FF4500;
        }
        
        .timer {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
            color: #FFD700;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #32CD32, #228B22);
            width: 0%;
            transition: width 0.3s;
        }
        
        .info {
            margin-top: 15px;
            font-size: 14px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ” ìˆ¨ì€ ê·¸ë¦¼ ì°¾ê¸°</h1>
        
        <div class="ui">
            <div class="stat">ğŸ¯ ì°¾ì€ ê°œìˆ˜: <span id="foundCount">0</span>/<span id="totalCount">0</span></div>
            <div class="stat">ğŸ’¡ íŒíŠ¸: <span id="hintsLeft">3</span>ê°œ</div>
            <div class="stat">â­ ì ìˆ˜: <span id="score">0</span></div>
        </div>
        
        <div class="timer" id="timer">â° 03:00</div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="difficulty-selector">
            <button class="difficulty-btn active" onclick="setDifficulty('easy')">ì‰¬ì›€ (5ê°œ)</button>
            <button class="difficulty-btn" onclick="setDifficulty('medium')">ë³´í†µ (8ê°œ)</button>
            <button class="difficulty-btn" onclick="setDifficulty('hard')">ì–´ë ¤ì›€ (12ê°œ)</button>
        </div>
        
        <div class="controls">
            <button class="control-btn" onclick="startNewGame()">ğŸ® ìƒˆ ê²Œì„</button>
            <button class="control-btn" onclick="pauseGame()">â¸ï¸ ì¼ì‹œì •ì§€</button>
            <button class="control-btn" onclick="showAllObjects()">ğŸ‘ï¸ ëª¨ë“  ë¬¼ê±´ ë³´ê¸°</button>
        </div>
        
        <div class="game-area">
            <canvas id="gameCanvas" width="700" height="500"></canvas>
            
            <div class="sidebar">
                <h3>ğŸ¯ ì°¾ì„ ë¬¼ê±´ë“¤</h3>
                <div class="objects-list" id="objectsList">
                    <!-- ë¬¼ê±´ ëª©ë¡ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
        
        <div class="info">
            <p>ğŸ® ì¡°ì‘ë²•: ìˆ¨ì–´ìˆëŠ” ë¬¼ê±´ë“¤ì„ í´ë¦­í•´ì„œ ì°¾ì•„ë³´ì„¸ìš”!</p>
            <p>ğŸ’¡ íŒ: íŒíŠ¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¬¼ê±´ì˜ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤!</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // ê²Œì„ ìƒíƒœ
        let gameState = {
            difficulty: 'easy',
            objects: [],
            foundObjects: [],
            hintsLeft: 3,
            score: 0,
            timeLeft: 180, // 3ë¶„
            gameRunning: false,
            isPaused: false,
            timer: null
        };
        
        // ë¬¼ê±´ ë°ì´í„°ë² ì´ìŠ¤
        const objectDatabase = [
            { name: 'ğŸ ì‚¬ê³¼', emoji: 'ğŸ', size: 25, color: '#FF0000' },
            { name: 'âš½ ì¶•êµ¬ê³µ', emoji: 'âš½', size: 30, color: '#000000' },
            { name: 'ğŸŒŸ ë³„', emoji: 'â­', size: 20, color: '#FFD700' },
            { name: 'ğŸˆ í’ì„ ', emoji: 'ğŸˆ', size: 25, color: '#FF69B4' },
            { name: 'ğŸŒ ë°”ë‚˜ë‚˜', emoji: 'ğŸŒ', size: 28, color: '#FFFF00' },
            { name: 'ğŸ¯ ë‹¤íŠ¸', emoji: 'ğŸ¯', size: 22, color: '#FF0000' },
            { name: 'ğŸª í…íŠ¸', emoji: 'ğŸª', size: 35, color: '#FF1493' },
            { name: 'ğŸ¨ íŒ”ë ˆíŠ¸', emoji: 'ğŸ¨', size: 26, color: '#8A2BE2' },
            { name: 'ğŸ­ ê°€ë©´', emoji: 'ğŸ­', size: 24, color: '#4169E1' },
            { name: 'ğŸª ì„œì»¤ìŠ¤', emoji: 'ğŸ ', size: 32, color: '#FF6347' },
            { name: 'ğŸ² ì£¼ì‚¬ìœ„', emoji: 'ğŸ²', size: 20, color: '#FFFFFF' },
            { name: 'ğŸ¸ ê¸°íƒ€', emoji: 'ğŸ¸', size: 30, color: '#8B4513' },
            { name: 'ğŸº íŠ¸ëŸ¼í«', emoji: 'ğŸº', size: 28, color: '#FFD700' },
            { name: 'ğŸ» ë°”ì´ì˜¬ë¦°', emoji: 'ğŸ»', size: 26, color: '#8B4513' },
            { name: 'ğŸ¹ í”¼ì•„ë…¸', emoji: 'ğŸ¹', size: 35, color: '#000000' }
        ];
        
        // ë‚œì´ë„ë³„ ì„¤ì •
        const difficultySettings = {
            easy: { objectCount: 5, timeLimit: 180, hintCount: 3 },
            medium: { objectCount: 8, timeLimit: 240, hintCount: 2 },
            hard: { objectCount: 12, timeLimit: 300, hintCount: 1 }
        };
        
        // ë‚œì´ë„ ì„¤ì •
        function setDifficulty(difficulty) {
            gameState.difficulty = difficulty;
            document.querySelectorAll('.difficulty-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        // ìƒˆ ê²Œì„ ì‹œì‘
        function startNewGame() {
            const settings = difficultySettings[gameState.difficulty];
            
            gameState.objects = [];
            gameState.foundObjects = [];
            gameState.hintsLeft = settings.hintCount;
            gameState.score = 0;
            gameState.timeLeft = settings.timeLimit;
            gameState.gameRunning = true;
            gameState.isPaused = false;
            
            generateObjects(settings.objectCount);
            createObjectsList();
            startTimer();
            updateUI();
            render();
        }
        
        // ë¬¼ê±´ë“¤ ìƒì„±
        function generateObjects(count) {
            const selectedObjects = [];
            const availableObjects = [...objectDatabase];
            
            for (let i = 0; i < count; i++) {
                const randomIndex = Math.floor(Math.random() * availableObjects.length);
                const obj = availableObjects.splice(randomIndex, 1)[0];
                
                // ëœë¤ ìœ„ì¹˜ ìƒì„± (ê²¹ì¹˜ì§€ ì•Šê²Œ)
                let x, y, attempts = 0;
                do {
                    x = Math.random() * (canvas.width - obj.size * 2) + obj.size;
                    y = Math.random() * (canvas.height - obj.size * 2) + obj.size;
                    attempts++;
                } while (attempts < 50 && isOverlapping(x, y, obj.size));
                
                selectedObjects.push({
                    ...obj,
                    x: x,
                    y: y,
                    found: false,
                    id: i
                });
            }
            
            gameState.objects = selectedObjects;
        }
        
        // ê²¹ì¹¨ ì²´í¬
        function isOverlapping(x, y, size) {
            return gameState.objects.some(obj => {
                const distance = Math.sqrt((x - obj.x) ** 2 + (y - obj.y) ** 2);
                return distance < (size + obj.size);
            });
        }
        
        // ë¬¼ê±´ ëª©ë¡ ìƒì„±
        function createObjectsList() {
            const list = document.getElementById('objectsList');
            list.innerHTML = '';
            
            gameState.objects.forEach((obj, index) => {
                const item = document.createElement('div');
                item.className = 'object-item';
                item.innerHTML = `
                    <span>${obj.name}</span>
                    <button class="hint-btn" onclick="useHint(${index})" ${gameState.hintsLeft <= 0 ? 'disabled' : ''}>
                        ğŸ’¡
                    </button>
                `;
                list.appendChild(item);
            });
        }
        
        // íŒíŠ¸ ì‚¬ìš©
        function useHint(objectIndex) {
            if (gameState.hintsLeft <= 0 || gameState.objects[objectIndex].found) return;
            
            gameState.hintsLeft--;
            const obj = gameState.objects[objectIndex];
            
            // íŒíŠ¸ ì› ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#FFD700';
            ctx.lineWidth = 3;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.arc(obj.x, obj.y, obj.size + 10, 0, Math.PI * 2);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // 3ì´ˆ í›„ íŒíŠ¸ ì œê±°
            setTimeout(() => {
                render();
            }, 3000);
            
            updateUI();
        }
        
        // ìº”ë²„ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸
        canvas.addEventListener('click', (e) => {
            if (!gameState.gameRunning || gameState.isPaused) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // í´ë¦­í•œ ìœ„ì¹˜ì— ë¬¼ê±´ì´ ìˆëŠ”ì§€ í™•ì¸
            gameState.objects.forEach((obj, index) => {
                if (!obj.found) {
                    const distance = Math.sqrt((x - obj.x) ** 2 + (y - obj.y) ** 2);
                    if (distance <= obj.size) {
                        findObject(index);
                    }
                }
            });
        });
        
        // ë¬¼ê±´ ì°¾ê¸°
        function findObject(index) {
            const obj = gameState.objects[index];
            obj.found = true;
            gameState.foundObjects.push(obj);
            gameState.score += 100;
            
            // ì‹œê°ì  íš¨ê³¼
            createParticles(obj.x, obj.y);
            
            // ëª©ë¡ ì—…ë°ì´íŠ¸
            const listItems = document.querySelectorAll('.object-item');
            listItems[index].classList.add('found');
            
            // ê²Œì„ ì™„ë£Œ ì²´í¬
            if (gameState.foundObjects.length === gameState.objects.length) {
                gameComplete();
            }
            
            updateUI();
            render();
        }
        
        // íŒŒí‹°í´ íš¨ê³¼
        function createParticles(x, y) {
            const particles = [];
            for (let i = 0; i < 10; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    life: 30,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`
                });
            }
            
            const animateParticles = () => {
                ctx.save();
                particles.forEach((particle, index) => {
                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.vx *= 0.95;
                    particle.vy *= 0.95;
                    particle.life--;
                    
                    ctx.globalAlpha = particle.life / 30;
                    ctx.fillStyle = particle.color;
                    ctx.beginPath();
                    ctx.arc(particle.x, particle.y, 3, 0, Math.PI * 2);
                    ctx.fill();
                    
                    if (particle.life <= 0) {
                        particles.splice(index, 1);
                    }
                });
                ctx.restore();
                
                if (particles.length > 0) {
                    requestAnimationFrame(animateParticles);
                }
            };
            
            animateParticles();
        }
        
        // ê²Œì„ ì™„ë£Œ
        function gameComplete() {
            gameState.gameRunning = false;
            clearInterval(gameState.timer);
            
            const timeBonus = gameState.timeLeft * 10;
            gameState.score += timeBonus;
            
            setTimeout(() => {
                alert(`ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ëª¨ë“  ë¬¼ê±´ì„ ì°¾ì•˜ì–´ìš”!\nìµœì¢… ì ìˆ˜: ${gameState.score}ì \nì‹œê°„ ë³´ë„ˆìŠ¤: ${timeBonus}ì `);
            }, 500);
        }
        
        // ê²Œì„ ì¼ì‹œì •ì§€
        function pauseGame() {
            if (!gameState.gameRunning) return;
            
            gameState.isPaused = !gameState.isPaused;
            
            if (gameState.isPaused) {
                clearInterval(gameState.timer);
                event.target.textContent = 'â–¶ï¸ ê³„ì†í•˜ê¸°';
            } else {
                startTimer();
                event.target.textContent = 'â¸ï¸ ì¼ì‹œì •ì§€';
            }
        }
        
        // ëª¨ë“  ë¬¼ê±´ ë³´ê¸° (ì¹˜íŠ¸)
        function showAllObjects() {
            if (confirm('ëª¨ë“  ë¬¼ê±´ì˜ ìœ„ì¹˜ë¥¼ ë³´ì‹œê² ìŠµë‹ˆê¹Œ? (ì ìˆ˜ê°€ ì ˆë°˜ìœ¼ë¡œ ì¤„ì–´ë“­ë‹ˆë‹¤)')) {
                gameState.score = Math.floor(gameState.score / 2);
                
                ctx.save();
                ctx.strokeStyle = '#FF0000';
                ctx.lineWidth = 2;
                gameState.objects.forEach(obj => {
                    if (!obj.found) {
                        ctx.beginPath();
                        ctx.arc(obj.x, obj.y, obj.size + 5, 0, Math.PI * 2);
                        ctx.stroke();
                    }
                });
                ctx.restore();
                
                setTimeout(() => {
                    render();
                }, 5000);
                
                updateUI();
            }
        }
        
        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            gameState.timer = setInterval(() => {
                if (gameState.gameRunning && !gameState.isPaused) {
                    gameState.timeLeft--;
                    
                    if (gameState.timeLeft <= 0) {
                        gameOver();
                    }
                    
                    updateUI();
                }
            }, 1000);
        }
        
        // ê²Œì„ ì˜¤ë²„
        function gameOver() {
            gameState.gameRunning = false;
            clearInterval(gameState.timer);
            
            setTimeout(() => {
                alert(`â° ì‹œê°„ ì¢…ë£Œ!\nì°¾ì€ ë¬¼ê±´: ${gameState.foundObjects.length}/${gameState.objects.length}\nìµœì¢… ì ìˆ˜: ${gameState.score}ì `);
            }, 500);
        }
        
        // ë Œë”ë§
        function render() {
            // ë°°ê²½
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(0.5, '#98FB98');
            gradient.addColorStop(1, '#F0E68C');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ë°°ê²½ ì¥ì‹
            drawBackground();
            
            // ë¬¼ê±´ë“¤ ê·¸ë¦¬ê¸°
            gameState.objects.forEach(obj => {
                if (!obj.found) {
                    ctx.font = `${obj.size}px Arial`;
                    ctx.textAlign = 'center';
                    ctx.fillText(obj.emoji, obj.x, obj.y + obj.size/3);
                }
            });
            
            // ì°¾ì€ ë¬¼ê±´ë“¤ì€ ë°˜íˆ¬ëª…ìœ¼ë¡œ
            ctx.globalAlpha = 0.3;
            gameState.foundObjects.forEach(obj => {
                ctx.font = `${obj.size}px Arial`;
                ctx.textAlign = 'center';
                ctx.fillText(obj.emoji, obj.x, obj.y + obj.size/3);
                
                // ì²´í¬ ë§ˆí¬
                ctx.fillStyle = '#00FF00';
                ctx.font = '20px Arial';
                ctx.fillText('âœ“', obj.x + obj.size, obj.y - obj.size);
            });
            ctx.globalAlpha = 1;
        }
        
        // ë°°ê²½ ì¥ì‹ ê·¸ë¦¬ê¸°
        function drawBackground() {
            // ë‚˜ë¬´ë“¤
            for (let i = 0; i < 5; i++) {
                const x = (i + 1) * (canvas.width / 6);
                const y = canvas.height - 50;
                
                // ë‚˜ë¬´ ì¤„ê¸°
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(x - 5, y - 40, 10, 40);
                
                // ë‚˜ë¬´ ì
                ctx.fillStyle = '#228B22';
                ctx.beginPath();
                ctx.arc(x, y - 40, 20, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // êµ¬ë¦„ë“¤
            for (let i = 0; i < 3; i++) {
                const x = (i + 1) * (canvas.width / 4);
                const y = 50;
                
                ctx.fillStyle = '#FFFFFF';
                ctx.beginPath();
                ctx.arc(x - 15, y, 15, 0, Math.PI * 2);
                ctx.arc(x, y, 20, 0, Math.PI * 2);
                ctx.arc(x + 15, y, 15, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // ê½ƒë“¤
            for (let i = 0; i < 8; i++) {
                const x = Math.random() * canvas.width;
                const y = canvas.height - Math.random() * 100 - 20;
                
                ctx.fillStyle = `hsl(${Math.random() * 360}, 70%, 60%)`;
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            document.getElementById('foundCount').textContent = gameState.foundObjects.length;
            document.getElementById('totalCount').textContent = gameState.objects.length;
            document.getElementById('hintsLeft').textContent = gameState.hintsLeft;
            document.getElementById('score').textContent = gameState.score;
            
            // íƒ€ì´ë¨¸
            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            document.getElementById('timer').textContent = `â° ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // ì§„í–‰ë„ ë°”
            const progress = (gameState.foundObjects.length / Math.max(1, gameState.objects.length)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // íŒíŠ¸ ë²„íŠ¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.hint-btn').forEach((btn, index) => {
                btn.disabled = gameState.hintsLeft <= 0 || gameState.objects[index]?.found;
            });
        }
        
        // ê²Œì„ ì‹œì‘
        render();
    </script>
</body>
</html>