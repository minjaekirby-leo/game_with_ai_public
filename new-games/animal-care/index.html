<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¾ ì„œì»¤ìŠ¤ ë™ë¬¼ ëŒë³´ê¸°</title>
    
    <!-- Google Analytics -->
    <script src="../../analytics.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #98FB98, #90EE90, #32CD32);
            font-family: 'Comic Sans MS', cursive;
            color: white;
            overflow: hidden;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .title {
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(152, 251, 152, 0.8);
        }

        .animal-area {
            width: 700px;
            height: 450px;
            background: linear-gradient(45deg, #228B22, #32CD32);
            border: 3px solid #FFD700;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .animal {
            width: 80px;
            height: 80px;
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 3px solid white;
        }

        .animal:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .animal.selected {
            border-color: #FFD700;
            box-shadow: 0 0 20px #FFD700;
        }

        .animal.happy {
            animation: bounce 0.5s ease-in-out;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .need-indicator {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }

        .care-tools {
            position: absolute;
            left: 20px;
            top: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            width: 120px;
        }

        .tool-btn {
            display: flex;
            align-items: center;
            margin: 8px 0;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tool-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .tool-btn.selected {
            background: rgba(255, 215, 0, 0.3);
            border: 2px solid #FFD700;
        }

        .tool-icon {
            font-size: 1.5rem;
            margin-right: 8px;
        }

        .animal-info {
            position: absolute;
            right: 20px;
            top: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            width: 150px;
        }

        .happiness-bar {
            width: 100%;
            height: 10px;
            background: #333;
            border-radius: 5px;
            margin: 5px 0;
            overflow: hidden;
        }

        .happiness-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ffff00, #00ff00);
            transition: width 0.5s ease;
        }

        .controls {
            margin-top: 30px;
            text-align: center;
        }

        .control-btn {
            background: linear-gradient(45deg, #98FB98, #32CD32);
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 0 10px;
            border-radius: 25px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(152, 251, 152, 0.5);
        }

        .score {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 1.5rem;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 15px;
        }

        .instructions {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            font-size: 0.9rem;
            max-width: 200px;
        }

        .care-effect {
            position: absolute;
            font-size: 1.5rem;
            animation: careFloat 2s ease-out forwards;
            pointer-events: none;
        }

        @keyframes careFloat {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-50px) scale(1.5); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">ğŸ¾ ì„œì»¤ìŠ¤ ë™ë¬¼ ëŒë³´ê¸° ğŸ¾</h1>
        
        <div class="instructions">
            ğŸ¯ ì¡°ì‘ë²•:<br>
            â€¢ ë„êµ¬ ì„ íƒ<br>
            â€¢ ë™ë¬¼ í´ë¦­í•˜ì—¬ ëŒë³´ê¸°<br>
            â€¢ ëª¨ë“  ë™ë¬¼ì„ í–‰ë³µí•˜ê²Œ!
        </div>

        <div class="score">í–‰ë³µë„: <span id="score">0</span>%</div>

        <div class="animal-area" id="animalArea">
            <div class="care-tools">
                <h4>ğŸ› ï¸ ë„êµ¬</h4>
                <div class="tool-btn selected" data-tool="food" onclick="selectTool('food')">
                    <span class="tool-icon">ğŸ¥•</span>
                    <span>ë¨¹ì´</span>
                </div>
                <div class="tool-btn" data-tool="water" onclick="selectTool('water')">
                    <span class="tool-icon">ğŸ’§</span>
                    <span>ë¬¼</span>
                </div>
                <div class="tool-btn" data-tool="brush" onclick="selectTool('brush')">
                    <span class="tool-icon">ğŸ§½</span>
                    <span>ëª©ìš•</span>
                </div>
                <div class="tool-btn" data-tool="toy" onclick="selectTool('toy')">
                    <span class="tool-icon">ğŸ¾</span>
                    <span>ë†€ì´</span>
                </div>
                <div class="tool-btn" data-tool="medicine" onclick="selectTool('medicine')">
                    <span class="tool-icon">ğŸ’Š</span>
                    <span>ì¹˜ë£Œ</span>
                </div>
            </div>

            <div class="animal-info" id="animalInfo">
                <h4>ğŸ¾ ì„ íƒëœ ë™ë¬¼</h4>
                <div id="selectedAnimalName">ë™ë¬¼ì„ ì„ íƒí•˜ì„¸ìš”</div>
                <div>í–‰ë³µë„:</div>
                <div class="happiness-bar">
                    <div class="happiness-fill" id="happinessFill" style="width: 0%;"></div>
                </div>
                <div id="animalNeeds">í•„ìš”: ì—†ìŒ</div>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn" onclick="feedAllAnimals()">ğŸ ëª¨ë“  ë™ë¬¼ ë¨¹ì´ì£¼ê¸°</button>
            <button class="control-btn" onclick="resetGame()">ğŸ”„ ë‹¤ì‹œ ì‹œì‘</button>
            <button class="control-btn" onclick="goHome()">ğŸ  í™ˆìœ¼ë¡œ</button>
        </div>
    </div>

    <script>
        let selectedTool = 'food';
        let selectedAnimal = null;
        let animals = [];
        let totalHappiness = 0;

        const animalArea = document.getElementById('animalArea');
        const scoreElement = document.getElementById('score');
        const animalInfo = document.getElementById('animalInfo');
        const selectedAnimalName = document.getElementById('selectedAnimalName');
        const happinessFill = document.getElementById('happinessFill');
        const animalNeeds = document.getElementById('animalNeeds');

        const animalTypes = [
            { emoji: 'ğŸ¦', name: 'ì‚¬ì', color: '#DAA520', needs: ['food', 'water', 'toy'] },
            { emoji: 'ğŸ˜', name: 'ì½”ë¼ë¦¬', color: '#708090', needs: ['food', 'water', 'brush'] },
            { emoji: 'ğŸµ', name: 'ì›ìˆ­ì´', color: '#8B4513', needs: ['food', 'toy', 'medicine'] },
            { emoji: 'ğŸ…', name: 'í˜¸ë‘ì´', color: '#FF8C00', needs: ['food', 'water', 'toy'] },
            { emoji: 'ğŸ»', name: 'ê³°', color: '#654321', needs: ['food', 'brush', 'toy'] },
            { emoji: 'ğŸ¦’', name: 'ê¸°ë¦°', color: '#DEB887', needs: ['food', 'water', 'brush'] }
        ];

        function initializeGame() {
            animals = [];
            animalArea.innerHTML = '';
            
            // ë„êµ¬ íŒ¨ë„ê³¼ ì •ë³´ íŒ¨ë„ ë‹¤ì‹œ ì¶”ê°€
            createToolsPanel();
            createInfoPanel();
            
            // ë™ë¬¼ë“¤ ìƒì„±
            animalTypes.forEach((type, index) => {
                const animal = {
                    ...type,
                    happiness: Math.floor(Math.random() * 50) + 25, // 25-75%
                    currentNeed: type.needs[Math.floor(Math.random() * type.needs.length)],
                    element: null
                };
                
                const animalElement = document.createElement('div');
                animalElement.className = 'animal';
                animalElement.style.background = type.color;
                animalElement.style.left = (100 + (index % 3) * 200) + 'px';
                animalElement.style.top = (100 + Math.floor(index / 3) * 150) + 'px';
                animalElement.innerHTML = type.emoji;
                animalElement.addEventListener('click', () => selectAnimal(animal));
                
                // í•„ìš” í‘œì‹œê¸° ì¶”ê°€
                const needIndicator = document.createElement('div');
                needIndicator.className = 'need-indicator';
                needIndicator.style.background = getNeedColor(animal.currentNeed);
                needIndicator.textContent = getNeedEmoji(animal.currentNeed);
                animalElement.appendChild(needIndicator);
                
                animal.element = animalElement;
                animalArea.appendChild(animalElement);
                animals.push(animal);
            });
            
            updateTotalHappiness();
        }

        function createToolsPanel() {
            const toolsPanel = document.createElement('div');
            toolsPanel.className = 'care-tools';
            toolsPanel.innerHTML = `
                <h4>ğŸ› ï¸ ë„êµ¬</h4>
                <div class="tool-btn selected" data-tool="food" onclick="selectTool('food')">
                    <span class="tool-icon">ğŸ¥•</span>
                    <span>ë¨¹ì´</span>
                </div>
                <div class="tool-btn" data-tool="water" onclick="selectTool('water')">
                    <span class="tool-icon">ğŸ’§</span>
                    <span>ë¬¼</span>
                </div>
                <div class="tool-btn" data-tool="brush" onclick="selectTool('brush')">
                    <span class="tool-icon">ğŸ§½</span>
                    <span>ëª©ìš•</span>
                </div>
                <div class="tool-btn" data-tool="toy" onclick="selectTool('toy')">
                    <span class="tool-icon">ğŸ¾</span>
                    <span>ë†€ì´</span>
                </div>
                <div class="tool-btn" data-tool="medicine" onclick="selectTool('medicine')">
                    <span class="tool-icon">ğŸ’Š</span>
                    <span>ì¹˜ë£Œ</span>
                </div>
            `;
            animalArea.appendChild(toolsPanel);
        }

        function createInfoPanel() {
            const infoPanel = document.createElement('div');
            infoPanel.className = 'animal-info';
            infoPanel.innerHTML = `
                <h4>ğŸ¾ ì„ íƒëœ ë™ë¬¼</h4>
                <div id="selectedAnimalName">ë™ë¬¼ì„ ì„ íƒí•˜ì„¸ìš”</div>
                <div>í–‰ë³µë„:</div>
                <div class="happiness-bar">
                    <div class="happiness-fill" id="happinessFill" style="width: 0%;"></div>
                </div>
                <div id="animalNeeds">í•„ìš”: ì—†ìŒ</div>
            `;
            animalArea.appendChild(infoPanel);
        }

        function selectTool(tool) {
            selectedTool = tool;
            
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            document.querySelector(`[data-tool="${tool}"]`).classList.add('selected');
        }

        function selectAnimal(animal) {
            selectedAnimal = animal;
            
            // ëª¨ë“  ë™ë¬¼ ì„ íƒ í•´ì œ
            animals.forEach(a => a.element.classList.remove('selected'));
            
            // ì„ íƒëœ ë™ë¬¼ ê°•ì¡°
            animal.element.classList.add('selected');
            
            // ì •ë³´ ì—…ë°ì´íŠ¸
            updateAnimalInfo();
        }

        function updateAnimalInfo() {
            if (!selectedAnimal) return;
            
            document.getElementById('selectedAnimalName').textContent = selectedAnimal.name;
            document.getElementById('happinessFill').style.width = selectedAnimal.happiness + '%';
            document.getElementById('animalNeeds').textContent = `í•„ìš”: ${getNeedName(selectedAnimal.currentNeed)}`;
        }

        function careForAnimal(animal) {
            if (!selectedTool) return;
            
            let happinessIncrease = 0;
            let effectEmoji = '';
            
            if (selectedTool === animal.currentNeed) {
                // ì˜¬ë°”ë¥¸ ë„êµ¬ ì‚¬ìš©
                happinessIncrease = 20;
                effectEmoji = 'ğŸ’–';
                
                // ìƒˆë¡œìš´ í•„ìš” ìƒì„±
                animal.currentNeed = animal.needs[Math.floor(Math.random() * animal.needs.length)];
                updateNeedIndicator(animal);
            } else if (animal.needs.includes(selectedTool)) {
                // í•„ìš”í•œ ë„êµ¬ì´ì§€ë§Œ ìš°ì„ ìˆœìœ„ê°€ ì•„ë‹˜
                happinessIncrease = 10;
                effectEmoji = 'ğŸ˜Š';
            } else {
                // ì˜ëª»ëœ ë„êµ¬
                happinessIncrease = 5;
                effectEmoji = 'ğŸ˜';
            }
            
            animal.happiness = Math.min(100, animal.happiness + happinessIncrease);
            
            // ì‹œê°ì  íš¨ê³¼
            animal.element.classList.add('happy');
            setTimeout(() => {
                animal.element.classList.remove('happy');
            }, 500);
            
            showCareEffect(animal.element, effectEmoji);
            updateAnimalInfo();
            updateTotalHappiness();
        }

        function updateNeedIndicator(animal) {
            const indicator = animal.element.querySelector('.need-indicator');
            indicator.style.background = getNeedColor(animal.currentNeed);
            indicator.textContent = getNeedEmoji(animal.currentNeed);
        }

        function getNeedColor(need) {
            const colors = {
                'food': '#FF6347',
                'water': '#4169E1',
                'brush': '#32CD32',
                'toy': '#FFD700',
                'medicine': '#FF69B4'
            };
            return colors[need] || '#333';
        }

        function getNeedEmoji(need) {
            const emojis = {
                'food': 'ğŸ',
                'water': 'ğŸ’§',
                'brush': 'ğŸ§½',
                'toy': 'ğŸ¾',
                'medicine': 'ğŸ’Š'
            };
            return emojis[need] || 'â“';
        }

        function getNeedName(need) {
            const names = {
                'food': 'ë¨¹ì´',
                'water': 'ë¬¼',
                'brush': 'ëª©ìš•',
                'toy': 'ë†€ì´',
                'medicine': 'ì¹˜ë£Œ'
            };
            return names[need] || 'ì•Œ ìˆ˜ ì—†ìŒ';
        }

        function showCareEffect(element, emoji) {
            const effect = document.createElement('div');
            effect.className = 'care-effect';
            effect.textContent = emoji;
            
            const rect = element.getBoundingClientRect();
            const areaRect = animalArea.getBoundingClientRect();
            
            effect.style.left = (rect.left - areaRect.left + 40) + 'px';
            effect.style.top = (rect.top - areaRect.top + 20) + 'px';
            
            animalArea.appendChild(effect);
            
            setTimeout(() => {
                if (effect.parentNode) {
                    effect.parentNode.removeChild(effect);
                }
            }, 2000);
        }

        function feedAllAnimals() {
            animals.forEach(animal => {
                animal.happiness = Math.min(100, animal.happiness + 15);
                animal.element.classList.add('happy');
                setTimeout(() => {
                    animal.element.classList.remove('happy');
                }, 500);
                showCareEffect(animal.element, 'ğŸ');
            });
            
            updateAnimalInfo();
            updateTotalHappiness();
        }

        function updateTotalHappiness() {
            totalHappiness = Math.round(animals.reduce((sum, animal) => sum + animal.happiness, 0) / animals.length);
            scoreElement.textContent = totalHappiness;
        }

        function resetGame() {
            selectedAnimal = null;
            selectedTool = 'food';
            initializeGame();
        }

        function goHome() {
            window.location.href = '../../index.html';
        }

        // ë™ë¬¼ í´ë¦­ ì´ë²¤íŠ¸ (ì „ì—­)
        animalArea.addEventListener('click', (e) => {
            const animalElement = e.target.closest('.animal');
            if (animalElement) {
                const animal = animals.find(a => a.element === animalElement);
                if (animal) {
                    if (selectedAnimal === animal) {
                        // ì´ë¯¸ ì„ íƒëœ ë™ë¬¼ì´ë©´ ëŒë³´ê¸°
                        careForAnimal(animal);
                    } else {
                        // ìƒˆë¡œìš´ ë™ë¬¼ ì„ íƒ
                        selectAnimal(animal);
                    }
                }
            }
        });

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case '1':
                    selectTool('food');
                    break;
                case '2':
                    selectTool('water');
                    break;
                case '3':
                    selectTool('brush');
                    break;
                case '4':
                    selectTool('toy');
                    break;
                case '5':
                    selectTool('medicine');
                    break;
                case 'f':
                case 'F':
                    feedAllAnimals();
                    break;
                case 'r':
                case 'R':
                    resetGame();
                    break;
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            initializeGame();
        });
    </script>
</body>
</html>