<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ í–‰ì„± íƒí—˜</title>
    
    <!-- Google Analytics -->
    <script src="../../analytics.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #0F0F23, #1A1A2E);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
        }
        
        .game-container {
            text-align: center;
            background: rgba(0,0,0,0.9);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #4A90E2;
        }
        
        canvas {
            border: 3px solid #2E86AB;
            border-radius: 10px;
            background: #000011;
        }
        
        .ui {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(74, 144, 226, 0.8);
            padding: 8px 15px;
            border-radius: 20px;
            margin: 5px;
            font-weight: bold;
        }
        
        .controls {
            margin-top: 15px;
            font-size: 14px;
            color: #ccc;
        }
        
        .ship-status {
            margin: 10px 0;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .status-item {
            background: rgba(46, 134, 171, 0.6);
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 14px;
        }
        
        .upgrade-panel {
            margin: 15px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .upgrade-btn {
            background: #27AE60;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .upgrade-btn:hover {
            background: #229954;
            transform: scale(1.05);
        }
        
        .upgrade-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸŒ í–‰ì„± íƒí—˜ ê²Œì„</h1>
        
        <div class="ui">
            <div class="stat">â›½ ì—°ë£Œ: <span id="fuel">100</span></div>
            <div class="stat">ğŸ’ ìì›: <span id="resources">0</span></div>
            <div class="stat">ğŸŒŸ ì ìˆ˜: <span id="score">0</span></div>
            <div class="stat">ğŸª ë°œê²¬: <span id="planetsFound">0</span></div>
        </div>
        
        <div class="ship-status">
            <div class="status-item">ğŸš€ ì—”ì§„: <span id="engineLevel">1</span>ë‹¨ê³„</div>
            <div class="status-item">ğŸ›¡ï¸ ë³´í˜¸ë§‰: <span id="shieldLevel">1</span>ë‹¨ê³„</div>
            <div class="status-item">â›ï¸ ì±„êµ´ê¸°: <span id="drillLevel">1</span>ë‹¨ê³„</div>
        </div>
        
        <div class="upgrade-panel">
            <button class="upgrade-btn" onclick="upgrade('engine')" id="engineBtn">ğŸš€ ì—”ì§„ ì—…ê·¸ë ˆì´ë“œ (50ğŸ’)</button>
            <button class="upgrade-btn" onclick="upgrade('shield')" id="shieldBtn">ğŸ›¡ï¸ ë³´í˜¸ë§‰ ì—…ê·¸ë ˆì´ë“œ (30ğŸ’)</button>
            <button class="upgrade-btn" onclick="upgrade('drill')" id="drillBtn">â›ï¸ ì±„êµ´ê¸° ì—…ê·¸ë ˆì´ë“œ (40ğŸ’)</button>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="controls">
            <p>ğŸ® ì¡°ì‘ë²•: WASDë¡œ ìš°ì£¼ì„  ì¡°ì¢…, ìŠ¤í˜ì´ìŠ¤ë°”ë¡œ ë¶€ìŠ¤í„° ì‚¬ìš©</p>
            <p>ğŸŒ ëª©í‘œ: í–‰ì„±ë“¤ì„ íƒí—˜í•˜ê³  ìì›ì„ ìˆ˜ì§‘í•˜ì„¸ìš”!</p>
            <p>ğŸ’¡ íŒ: ì¤‘ë ¥ì„ ì´ìš©í•´ì„œ ì—°ë£Œë¥¼ ì ˆì•½í•˜ê³ , ì—…ê·¸ë ˆì´ë“œë¡œ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ì„¸ìš”!</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // ê²Œì„ ìƒíƒœ
        let gameState = {
            fuel: 100,
            resources: 0,
            score: 0,
            planetsFound: 0,
            engineLevel: 1,
            shieldLevel: 1,
            drillLevel: 1
        };
        
        // ìš°ì£¼ì„ 
        const ship = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            vx: 0,
            vy: 0,
            angle: 0,
            size: 15,
            thrust: 0.2,
            maxSpeed: 8,
            fuel: 100
        };
        
        // ê²Œì„ ê°ì²´ë“¤
        let planets = [];
        let stars = [];
        let particles = [];
        let resources = [];
        
        // í‚¤ ì…ë ¥
        const keys = {};
        document.addEventListener('keydown', (e) => keys[e.key.toLowerCase()] = true);
        document.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);
        
        // ë³„ë“¤ ìƒì„±
        function createStars() {
            for (let i = 0; i < 200; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2 + 0.5,
                    brightness: Math.random()
                });
            }
        }
        
        // í–‰ì„± ìƒì„±
        function createPlanet() {
            const planetTypes = [
                { color: '#FF6B6B', size: 40, gravity: 0.8, resources: 'iron' },
                { color: '#4ECDC4', size: 60, gravity: 1.2, resources: 'crystal' },
                { color: '#45B7D1', size: 35, gravity: 0.6, resources: 'water' },
                { color: '#96CEB4', size: 50, gravity: 1.0, resources: 'energy' },
                { color: '#FFEAA7', size: 80, gravity: 2.0, resources: 'gold' }
            ];
            
            const type = planetTypes[Math.floor(Math.random() * planetTypes.length)];
            
            planets.push({
                x: Math.random() * (canvas.width - 200) + 100,
                y: Math.random() * (canvas.height - 200) + 100,
                ...type,
                discovered: false,
                resourceAmount: Math.floor(Math.random() * 50) + 20,
                atmosphere: Math.random() > 0.5
            });
        }
        
        // ìì› ìƒì„±
        function createResource(x, y, type) {
            const resourceColors = {
                iron: '#8B4513',
                crystal: '#9370DB',
                water: '#4169E1',
                energy: '#FFD700',
                gold: '#FF8C00'
            };
            
            resources.push({
                x: x + (Math.random() - 0.5) * 60,
                y: y + (Math.random() - 0.5) * 60,
                type: type,
                color: resourceColors[type],
                value: Math.floor(Math.random() * 10) + 5,
                life: 300
            });
        }
        
        // ì—…ê·¸ë ˆì´ë“œ
        function upgrade(type) {
            const costs = {
                engine: 50 * gameState.engineLevel,
                shield: 30 * gameState.shieldLevel,
                drill: 40 * gameState.drillLevel
            };
            
            if (gameState.resources >= costs[type]) {
                gameState.resources -= costs[type];
                gameState[type + 'Level']++;
                updateUI();
            } else {
                alert('ìì›ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!');
            }
        }
        
        // íŒŒí‹°í´ ìƒì„±
        function createParticles(x, y, color, count = 8) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 6,
                    vy: (Math.random() - 0.5) * 6,
                    life: 30,
                    maxLife: 30,
                    color: color,
                    size: Math.random() * 3 + 1
                });
            }
        }
        
        // ì¤‘ë ¥ ê³„ì‚°
        function applyGravity() {
            planets.forEach(planet => {
                const dx = planet.x - ship.x;
                const dy = planet.y - ship.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < planet.size + 100) {
                    const force = planet.gravity / (distance * distance) * 1000;
                    ship.vx += (dx / distance) * force;
                    ship.vy += (dy / distance) * force;
                }
            });
        }
        
        // ì¶©ëŒ ê°ì§€
        function checkCollisions() {
            planets.forEach(planet => {
                const dx = planet.x - ship.x;
                const dy = planet.y - ship.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                // í–‰ì„± ë°œê²¬
                if (distance < planet.size + 50 && !planet.discovered) {
                    planet.discovered = true;
                    gameState.planetsFound++;
                    gameState.score += 100;
                    
                    // ìì› ìƒì„±
                    for (let i = 0; i < planet.resourceAmount; i++) {
                        createResource(planet.x, planet.y, planet.resources);
                    }
                    
                    createParticles(planet.x, planet.y, planet.color, 15);
                }
                
                // í–‰ì„± ì¶©ëŒ
                if (distance < planet.size + ship.size) {
                    const damage = 10 / gameState.shieldLevel;
                    gameState.fuel = Math.max(0, gameState.fuel - damage);
                    
                    // ë°˜ë°œë ¥
                    const pushForce = 2;
                    ship.vx -= (dx / distance) * pushForce;
                    ship.vy -= (dy / distance) * pushForce;
                    
                    createParticles(ship.x, ship.y, '#FF0000');
                }
            });
            
            // ìì› ìˆ˜ì§‘
            resources.forEach((resource, index) => {
                const dx = resource.x - ship.x;
                const dy = resource.y - ship.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 20) {
                    gameState.resources += resource.value * gameState.drillLevel;
                    gameState.score += resource.value * 5;
                    resources.splice(index, 1);
                    createParticles(resource.x, resource.y, resource.color);
                }
            });
        }
        
        // ì—…ë°ì´íŠ¸
        function update() {
            // ìš°ì£¼ì„  ì¡°ì‘
            const thrustPower = ship.thrust * gameState.engineLevel;
            
            if (keys['w'] || keys['ã…ˆ']) {
                ship.vx += Math.cos(ship.angle) * thrustPower;
                ship.vy += Math.sin(ship.angle) * thrustPower;
                gameState.fuel = Math.max(0, gameState.fuel - 0.1);
                
                // ì¶”ì§„ íŒŒí‹°í´
                createParticles(
                    ship.x - Math.cos(ship.angle) * 20,
                    ship.y - Math.sin(ship.angle) * 20,
                    '#FF4500', 2
                );
            }
            
            if (keys['a'] || keys['ã…']) ship.angle -= 0.1;
            if (keys['d'] || keys['ã…‡']) ship.angle += 0.1;
            
            // ë¶€ìŠ¤í„°
            if (keys[' '] && gameState.fuel > 5) {
                ship.vx += Math.cos(ship.angle) * thrustPower * 2;
                ship.vy += Math.sin(ship.angle) * thrustPower * 2;
                gameState.fuel -= 1;
                createParticles(ship.x, ship.y, '#00FFFF', 5);
            }
            
            // ì¤‘ë ¥ ì ìš©
            applyGravity();
            
            // ì†ë„ ì œí•œ
            const speed = Math.sqrt(ship.vx * ship.vx + ship.vy * ship.vy);
            if (speed > ship.maxSpeed) {
                ship.vx = (ship.vx / speed) * ship.maxSpeed;
                ship.vy = (ship.vy / speed) * ship.maxSpeed;
            }
            
            // ìš°ì£¼ì„  ì´ë™
            ship.x += ship.vx;
            ship.y += ship.vy;
            
            // í™”ë©´ ê²½ê³„ ì²˜ë¦¬ (ë©ì–´ë¼ìš´ë“œ)
            if (ship.x < 0) ship.x = canvas.width;
            if (ship.x > canvas.width) ship.x = 0;
            if (ship.y < 0) ship.y = canvas.height;
            if (ship.y > canvas.height) ship.y = 0;
            
            // ë§ˆì°°ë ¥
            ship.vx *= 0.99;
            ship.vy *= 0.99;
            
            // ì¶©ëŒ ì²´í¬
            checkCollisions();
            
            // ìƒˆ í–‰ì„± ìƒì„±
            if (Math.random() < 0.005 && planets.length < 8) {
                createPlanet();
            }
            
            // ìì› ìˆ˜ëª… ê°ì†Œ
            resources.forEach((resource, index) => {
                resource.life--;
                if (resource.life <= 0) {
                    resources.splice(index, 1);
                }
            });
            
            // íŒŒí‹°í´ ì—…ë°ì´íŠ¸
            particles.forEach((particle, index) => {
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.vx *= 0.95;
                particle.vy *= 0.95;
                particle.life--;
                
                if (particle.life <= 0) {
                    particles.splice(index, 1);
                }
            });
            
            // ì—°ë£Œ ìë™ íšŒë³µ (ë§¤ìš° ëŠë¦¬ê²Œ)
            if (gameState.fuel < 100) {
                gameState.fuel += 0.01;
            }
            
            // ê²Œì„ ì˜¤ë²„ ì²´í¬
            if (gameState.fuel <= 0) {
                alert(`ê²Œì„ ì˜¤ë²„!\në°œê²¬í•œ í–‰ì„±: ${gameState.planetsFound}ê°œ\nìµœì¢… ì ìˆ˜: ${gameState.score}ì `);
                location.reload();
            }
            
            updateUI();
        }
        
        // ë Œë”ë§
        function render() {
            // ìš°ì£¼ ë°°ê²½
            ctx.fillStyle = '#000011';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ë³„ë“¤
            stars.forEach(star => {
                ctx.fillStyle = `rgba(255, 255, 255, ${0.3 + star.brightness * 0.7})`;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // í–‰ì„±ë“¤
            planets.forEach(planet => {
                // í–‰ì„± ëŒ€ê¸°ê¶Œ (ìˆëŠ” ê²½ìš°)
                if (planet.atmosphere) {
                    ctx.fillStyle = `rgba(135, 206, 235, 0.2)`;
                    ctx.beginPath();
                    ctx.arc(planet.x, planet.y, planet.size + 15, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // í–‰ì„± ê·¸ë¦¼ì
                ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                ctx.beginPath();
                ctx.arc(planet.x + 3, planet.y + 3, planet.size, 0, Math.PI * 2);
                ctx.fill();
                
                // í–‰ì„± ëª¸ì²´
                ctx.fillStyle = planet.color;
                ctx.beginPath();
                ctx.arc(planet.x, planet.y, planet.size, 0, Math.PI * 2);
                ctx.fill();
                
                // í–‰ì„± í•˜ì´ë¼ì´íŠ¸
                ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.beginPath();
                ctx.arc(planet.x - planet.size * 0.3, planet.y - planet.size * 0.3, planet.size * 0.2, 0, Math.PI * 2);
                ctx.fill();
                
                // ë°œê²¬ë˜ì§€ ì•Šì€ í–‰ì„± í‘œì‹œ
                if (!planet.discovered) {
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 5]);
                    ctx.beginPath();
                    ctx.arc(planet.x, planet.y, planet.size + 20, 0, Math.PI * 2);
                    ctx.stroke();
                    ctx.setLineDash([]);
                }
                
                // ì¤‘ë ¥ì¥ í‘œì‹œ
                ctx.strokeStyle = `rgba(255, 255, 255, 0.1)`;
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.arc(planet.x, planet.y, planet.size + 50, 0, Math.PI * 2);
                ctx.stroke();
            });
            
            // ìì›ë“¤
            resources.forEach(resource => {
                const alpha = resource.life / 300;
                ctx.globalAlpha = alpha;
                
                ctx.fillStyle = resource.color;
                ctx.beginPath();
                ctx.arc(resource.x, resource.y, 5, 0, Math.PI * 2);
                ctx.fill();
                
                // ìì› ë°˜ì§ì„
                ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
                ctx.beginPath();
                ctx.arc(resource.x, resource.y, 3, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
            
            // ìš°ì£¼ì„ 
            ctx.save();
            ctx.translate(ship.x, ship.y);
            ctx.rotate(ship.angle);
            
            // ìš°ì£¼ì„  ëª¸ì²´
            ctx.fillStyle = '#4ECDC4';
            ctx.beginPath();
            ctx.moveTo(15, 0);
            ctx.lineTo(-10, -8);
            ctx.lineTo(-5, 0);
            ctx.lineTo(-10, 8);
            ctx.closePath();
            ctx.fill();
            
            // ìš°ì£¼ì„  ì°½ë¬¸
            ctx.fillStyle = '#87CEEB';
            ctx.beginPath();
            ctx.arc(5, 0, 4, 0, Math.PI * 2);
            ctx.fill();
            
            // ë³´í˜¸ë§‰ í‘œì‹œ
            if (gameState.shieldLevel > 1) {
                ctx.strokeStyle = 'rgba(0, 255, 255, 0.5)';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(0, 0, ship.size + 5, 0, Math.PI * 2);
                ctx.stroke();
            }
            
            ctx.restore();
            
            // íŒŒí‹°í´
            particles.forEach(particle => {
                const alpha = particle.life / particle.maxLife;
                ctx.globalAlpha = alpha;
                ctx.fillStyle = particle.color;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
            
            // ë¯¸ë‹ˆë§µ
            drawMinimap();
        }
        
        // ë¯¸ë‹ˆë§µ ê·¸ë¦¬ê¸°
        function drawMinimap() {
            const mapSize = 120;
            const mapX = canvas.width - mapSize - 10;
            const mapY = 10;
            
            // ë¯¸ë‹ˆë§µ ë°°ê²½
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(mapX, mapY, mapSize, mapSize);
            ctx.strokeStyle = '#4ECDC4';
            ctx.lineWidth = 2;
            ctx.strokeRect(mapX, mapY, mapSize, mapSize);
            
            // í–‰ì„±ë“¤
            planets.forEach(planet => {
                const x = mapX + (planet.x / canvas.width) * mapSize;
                const y = mapY + (planet.y / canvas.height) * mapSize;
                const size = Math.max(2, (planet.size / 80) * 8);
                
                ctx.fillStyle = planet.discovered ? planet.color : 'rgba(255, 255, 255, 0.3)';
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // ìš°ì£¼ì„ 
            const shipX = mapX + (ship.x / canvas.width) * mapSize;
            const shipY = mapY + (ship.y / canvas.height) * mapSize;
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.arc(shipX, shipY, 3, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            document.getElementById('fuel').textContent = Math.round(gameState.fuel);
            document.getElementById('resources').textContent = gameState.resources;
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('planetsFound').textContent = gameState.planetsFound;
            document.getElementById('engineLevel').textContent = gameState.engineLevel;
            document.getElementById('shieldLevel').textContent = gameState.shieldLevel;
            document.getElementById('drillLevel').textContent = gameState.drillLevel;
            
            // ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ ìƒíƒœ
            const engineCost = 50 * gameState.engineLevel;
            const shieldCost = 30 * gameState.shieldLevel;
            const drillCost = 40 * gameState.drillLevel;
            
            document.getElementById('engineBtn').textContent = `ğŸš€ ì—”ì§„ ì—…ê·¸ë ˆì´ë“œ (${engineCost}ğŸ’)`;
            document.getElementById('shieldBtn').textContent = `ğŸ›¡ï¸ ë³´í˜¸ë§‰ ì—…ê·¸ë ˆì´ë“œ (${shieldCost}ğŸ’)`;
            document.getElementById('drillBtn').textContent = `â›ï¸ ì±„êµ´ê¸° ì—…ê·¸ë ˆì´ë“œ (${drillCost}ğŸ’)`;
            
            document.getElementById('engineBtn').disabled = gameState.resources < engineCost;
            document.getElementById('shieldBtn').disabled = gameState.resources < shieldCost;
            document.getElementById('drillBtn').disabled = gameState.resources < drillCost;
        }
        
        // ê²Œì„ ë£¨í”„
        function gameLoop() {
            update();
            render();
            requestAnimationFrame(gameLoop);
        }
        
        // ê²Œì„ ì‹œì‘
        createStars();
        for (let i = 0; i < 5; i++) {
            createPlanet();
        }
        gameLoop();
    </script>
</body>
</html>