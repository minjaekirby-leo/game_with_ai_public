<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¥· ë‹Œì ìŠ¤í…”ìŠ¤</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1A1A2E, #16213E);
            font-family: 'Arial', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
        }
        
        .game-container {
            text-align: center;
            background: rgba(0,0,0,0.9);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #0F3460;
        }
        
        canvas {
            border: 3px solid #0F3460;
            border-radius: 10px;
            background: #0E1621;
        }
        
        .ui {
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(15, 52, 96, 0.8);
            padding: 8px 15px;
            border-radius: 20px;
            margin: 5px;
            font-weight: bold;
        }
        
        .mission-status {
            margin: 10px 0;
            padding: 10px;
            background: rgba(22, 33, 62, 0.8);
            border-radius: 10px;
            font-weight: bold;
        }
        
        .stealth-meter {
            width: 200px;
            height: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            margin: 10px auto;
            overflow: hidden;
        }
        
        .stealth-fill {
            height: 100%;
            background: linear-gradient(90deg, #E74C3C, #F39C12, #27AE60);
            transition: width 0.3s;
        }
        
        .controls {
            margin-top: 15px;
            font-size: 14px;
            color: #ccc;
        }
        
        .ninja-skills {
            margin: 10px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .skill-btn {
            background: #16213E;
            color: white;
            border: 2px solid #0F3460;
            padding: 8px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .skill-btn:hover {
            background: #0F3460;
            border-color: #E74C3C;
        }
        
        .skill-btn:disabled {
            background: #333;
            border-color: #555;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .alert-level {
            margin: 10px 0;
            font-size: 18px;
            font-weight: bold;
        }
        
        .alert-level.safe {
            color: #27AE60;
        }
        
        .alert-level.caution {
            color: #F39C12;
        }
        
        .alert-level.danger {
            color: #E74C3C;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ¥· ë‹Œì ìŠ¤í…”ìŠ¤</h1>
        
        <div class="ui">
            <div class="stat">ğŸ¯ ëª©í‘œ: <span id="objectives">0</span>/3</div>
            <div class="stat">ğŸ‘ï¸ ë°œê°: <span id="detections">0</span>íšŒ</div>
            <div class="stat">â­ ì ìˆ˜: <span id="score">0</span></div>
            <div class="stat">â±ï¸ ì‹œê°„: <span id="timer">05:00</span></div>
        </div>
        
        <div class="alert-level safe" id="alertLevel">
            ğŸŸ¢ ì•ˆì „ ìƒíƒœ
        </div>
        
        <div class="stealth-meter">
            <div class="stealth-fill" id="stealthFill" style="width: 100%;"></div>
        </div>
        
        <div class="mission-status" id="missionStatus">
            ë¯¸ì…˜: ê²½ë¹„ë¥¼ í”¼í•´ 3ê°œì˜ ë³´ë¬¼ì„ ìˆ˜ì§‘í•˜ì„¸ìš”!
        </div>
        
        <div class="ninja-skills">
            <button class="skill-btn" onclick="useSkill('smoke')" id="smokeBtn">ğŸ’¨ ì—°ë§‰íƒ„ (S)</button>
            <button class="skill-btn" onclick="useSkill('teleport')" id="teleportBtn">âš¡ ìˆœê°„ì´ë™ (T)</button>
            <button class="skill-btn" onclick="useSkill('invisible')" id="invisibleBtn">ğŸ‘» íˆ¬ëª…í™” (I)</button>
            <button class="skill-btn" onclick="useSkill('distraction')" id="distractionBtn">ğŸ¯ ì£¼ì˜ë¶„ì‚° (D)</button>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="controls">
            <p>ğŸ® ì¡°ì‘ë²•: WASDë¡œ ì´ë™, ê·¸ë¦¼ìì— ìˆ¨ì–´ ê²½ë¹„ë¥¼ í”¼í•˜ì„¸ìš”!</p>
            <p>ğŸ¥· ë‹Œì ê¸°ìˆ : S(ì—°ë§‰íƒ„), T(ìˆœê°„ì´ë™), I(íˆ¬ëª…í™”), D(ì£¼ì˜ë¶„ì‚°)</p>
            <p>ğŸ’¡ íŒ: ê²½ë¹„ì˜ ì‹œì•¼ì— ë“¤ì–´ê°€ì§€ ë§ê³  ì¡°ìš©íˆ ì›€ì§ì´ì„¸ìš”!</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // ê²Œì„ ìƒíƒœ
        let gameState = {
            objectives: 0,
            detections: 0,
            score: 0,
            timeLeft: 300, // 5ë¶„
            alertLevel: 0, // 0: ì•ˆì „, 1: ì£¼ì˜, 2: ìœ„í—˜
            stealthLevel: 100,
            gameRunning: true,
            timer: null
        };
        
        // ë‹Œì
        const ninja = {
            x: 50,
            y: 550,
            width: 15,
            height: 20,
            speed: 2,
            isHidden: false,
            isInvisible: false,
            invisibleTime: 0,
            lastMovement: 0
        };
        
        // ìŠ¤í‚¬ ì¿¨ë‹¤ìš´
        const skills = {
            smoke: { cooldown: 0, maxCooldown: 300 },
            teleport: { cooldown: 0, maxCooldown: 600 },
            invisible: { cooldown: 0, maxCooldown: 900 },
            distraction: { cooldown: 0, maxCooldown: 180 }
        };
        
        // ê²Œì„ ê°ì²´ë“¤
        let guards = [];
        let treasures = [];
        let shadows = [];
        let smokeClouds = [];
        let distractions = [];
        let particles = [];
        
        // í‚¤ ì…ë ¥
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            
            // ìŠ¤í‚¬ ë‹¨ì¶•í‚¤
            if (e.key.toLowerCase() === 's') useSkill('smoke');
            if (e.key.toLowerCase() === 't') useSkill('teleport');
            if (e.key.toLowerCase() === 'i') useSkill('invisible');
            if (e.key.toLowerCase() === 'd') useSkill('distraction');
        });
        document.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);
        
        // ë ˆë²¨ ìƒì„±
        function createLevel() {
            // ê²½ë¹„ ìƒì„±
            guards = [
                { 
                    x: 200, y: 300, width: 20, height: 25, 
                    vx: 1, vy: 0, 
                    patrol: { startX: 150, endX: 350, startY: 300, endY: 300 },
                    viewAngle: 0, viewDistance: 120, viewWidth: Math.PI / 3,
                    alertness: 0, maxAlertness: 100,
                    type: 'patrol'
                },
                { 
                    x: 500, y: 200, width: 20, height: 25, 
                    vx: 0, vy: 1, 
                    patrol: { startX: 500, endX: 500, startY: 150, endY: 350 },
                    viewAngle: Math.PI / 2, viewDistance: 100, viewWidth: Math.PI / 4,
                    alertness: 0, maxAlertness: 100,
                    type: 'patrol'
                },
                { 
                    x: 650, y: 450, width: 20, height: 25, 
                    vx: 0, vy: 0, 
                    patrol: { startX: 650, endX: 650, startY: 450, endY: 450 },
                    viewAngle: Math.PI, viewDistance: 150, viewWidth: Math.PI / 2,
                    alertness: 0, maxAlertness: 100,
                    type: 'stationary',
                    rotationSpeed: 0.02
                }
            ];
            
            // ë³´ë¬¼ ìƒì„±
            treasures = [
                { x: 300, y: 250, width: 15, height: 15, collected: false },
                { x: 550, y: 100, width: 15, height: 15, collected: false },
                { x: 700, y: 500, width: 15, height: 15, collected: false }
            ];
            
            // ê·¸ë¦¼ì ì˜ì—­ ìƒì„±
            shadows = [
                { x: 0, y: 0, width: 100, height: 600 },
                { x: 120, y: 200, width: 80, height: 200 },
                { x: 380, y: 100, width: 60, height: 150 },
                { x: 600, y: 300, width: 100, height: 100 },
                { x: 720, y: 0, width: 80, height: 300 }
            ];
        }
        
        // ìŠ¤í‚¬ ì‚¬ìš©
        function useSkill(skillName) {
            if (skills[skillName].cooldown > 0) return;
            
            switch(skillName) {
                case 'smoke':
                    smokeClouds.push({
                        x: ninja.x,
                        y: ninja.y,
                        radius: 50,
                        life: 180,
                        maxLife: 180
                    });
                    skills.smoke.cooldown = skills.smoke.maxCooldown;
                    break;
                    
                case 'teleport':
                    // ë§ˆìš°ìŠ¤ ìœ„ì¹˜ë¡œ ìˆœê°„ì´ë™ (ê°„ë‹¨íˆ ëœë¤ ìœ„ì¹˜ë¡œ)
                    ninja.x = Math.random() * (canvas.width - ninja.width);
                    ninja.y = Math.random() * (canvas.height - ninja.height);
                    createParticles(ninja.x, ninja.y, '#9B59B6', 10);
                    skills.teleport.cooldown = skills.teleport.maxCooldown;
                    break;
                    
                case 'invisible':
                    ninja.isInvisible = true;
                    ninja.invisibleTime = 120; // 2ì´ˆ
                    skills.invisible.cooldown = skills.invisible.maxCooldown;
                    break;
                    
                case 'distraction':
                    // ëœë¤ ìœ„ì¹˜ì— ì£¼ì˜ë¶„ì‚° ìƒì„±
                    distractions.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        life: 120,
                        maxLife: 120
                    });
                    skills.distraction.cooldown = skills.distraction.maxCooldown;
                    break;
            }
        }
        
        // íŒŒí‹°í´ ìƒì„±
        function createParticles(x, y, color, count = 5) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 6,
                    vy: (Math.random() - 0.5) * 6,
                    life: 30,
                    maxLife: 30,
                    color: color,
                    size: Math.random() * 3 + 1
                });
            }
        }
        
        // ì¶©ëŒ ê°ì§€
        function checkCollision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }
        
        // ì‹œì•¼ ë‚´ ê°ì§€
        function isInView(guard, target) {
            const dx = target.x - guard.x;
            const dy = target.y - guard.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            
            if (distance > guard.viewDistance) return false;
            
            const angleToTarget = Math.atan2(dy, dx);
            let angleDiff = Math.abs(angleToTarget - guard.viewAngle);
            
            // ê°ë„ ì •ê·œí™”
            if (angleDiff > Math.PI) angleDiff = 2 * Math.PI - angleDiff;
            
            return angleDiff <= guard.viewWidth / 2;
        }
        
        // ì—…ë°ì´íŠ¸
        function update() {
            if (!gameState.gameRunning) return;
            
            // ë‹Œì ì´ë™
            let moved = false;
            if (keys['w'] || keys['ã…ˆ']) { ninja.y -= ninja.speed; moved = true; }
            if (keys['s'] || keys['ã„´']) { ninja.y += ninja.speed; moved = true; }
            if (keys['a'] || keys['ã…']) { ninja.x -= ninja.speed; moved = true; }
            if (keys['d'] || keys['ã…‡']) { ninja.x += ninja.speed; moved = true; }
            
            // ê²½ê³„ ì²´í¬
            ninja.x = Math.max(0, Math.min(canvas.width - ninja.width, ninja.x));
            ninja.y = Math.max(0, Math.min(canvas.height - ninja.height, ninja.y));
            
            // ì›€ì§ì„ ê°ì§€
            if (moved) {
                ninja.lastMovement = 30; // 30í”„ë ˆì„ ë™ì•ˆ ì›€ì§ì„ ìƒíƒœ
                if (!ninja.isHidden && !ninja.isInvisible) {
                    gameState.stealthLevel = Math.max(0, gameState.stealthLevel - 2);
                }
            } else {
                if (ninja.lastMovement > 0) ninja.lastMovement--;
                if (ninja.isHidden || ninja.isInvisible) {
                    gameState.stealthLevel = Math.min(100, gameState.stealthLevel + 1);
                }
            }
            
            // ê·¸ë¦¼ìì— ìˆ¨ê¸°
            ninja.isHidden = false;
            shadows.forEach(shadow => {
                if (checkCollision(ninja, shadow)) {
                    ninja.isHidden = true;
                }
            });
            
            // ì—°ë§‰ ì†ì— ìˆ¨ê¸°
            smokeClouds.forEach(smoke => {
                const distance = Math.sqrt((ninja.x - smoke.x) ** 2 + (ninja.y - smoke.y) ** 2);
                if (distance < smoke.radius) {
                    ninja.isHidden = true;
                }
            });
            
            // íˆ¬ëª…í™” ì‹œê°„ ê°ì†Œ
            if (ninja.invisibleTime > 0) {
                ninja.invisibleTime--;
                if (ninja.invisibleTime <= 0) {
                    ninja.isInvisible = false;
                }
            }
            
            // ê²½ë¹„ ì—…ë°ì´íŠ¸
            guards.forEach(guard => {
                // ìˆœì°° ì´ë™
                if (guard.type === 'patrol') {
                    guard.x += guard.vx;
                    guard.y += guard.vy;
                    
                    // ìˆœì°° ê²½ë¡œ ì²´í¬
                    if (guard.x <= guard.patrol.startX || guard.x >= guard.patrol.endX) {
                        guard.vx *= -1;
                        guard.viewAngle = guard.vx > 0 ? 0 : Math.PI;
                    }
                    if (guard.y <= guard.patrol.startY || guard.y >= guard.patrol.endY) {
                        guard.vy *= -1;
                        guard.viewAngle = guard.vy > 0 ? Math.PI / 2 : -Math.PI / 2;
                    }
                } else if (guard.type === 'stationary') {
                    // íšŒì „í•˜ëŠ” ê²½ë¹„
                    guard.viewAngle += guard.rotationSpeed;
                }
                
                // ì£¼ì˜ë¶„ì‚°ì— ë°˜ì‘
                distractions.forEach(distraction => {
                    const distance = Math.sqrt((guard.x - distraction.x) ** 2 + (guard.y - distraction.y) ** 2);
                    if (distance < 100) {
                        guard.viewAngle = Math.atan2(distraction.y - guard.y, distraction.x - guard.x);
                    }
                });
                
                // ë‹Œì ê°ì§€
                if (!ninja.isHidden && !ninja.isInvisible && isInView(guard, ninja)) {
                    guard.alertness = Math.min(guard.maxAlertness, guard.alertness + 3);
                    gameState.stealthLevel = Math.max(0, gameState.stealthLevel - 5);
                    
                    if (guard.alertness >= guard.maxAlertness) {
                        // ë°œê°ë¨
                        gameState.detections++;
                        gameState.score = Math.max(0, gameState.score - 50);
                        guard.alertness = 0;
                        createParticles(ninja.x, ninja.y, '#E74C3C', 8);
                    }
                } else {
                    guard.alertness = Math.max(0, guard.alertness - 1);
                }
            });
            
            // ë³´ë¬¼ ìˆ˜ì§‘
            treasures.forEach(treasure => {
                if (!treasure.collected && checkCollision(ninja, treasure)) {
                    treasure.collected = true;
                    gameState.objectives++;
                    gameState.score += 100;
                    createParticles(treasure.x, treasure.y, '#F1C40F', 10);
                }
            });
            
            // ì—°ë§‰ ì—…ë°ì´íŠ¸
            smokeClouds.forEach((smoke, index) => {
                smoke.life--;
                if (smoke.life <= 0) {
                    smokeClouds.splice(index, 1);
                }
            });
            
            // ì£¼ì˜ë¶„ì‚° ì—…ë°ì´íŠ¸
            distractions.forEach((distraction, index) => {
                distraction.life--;
                if (distraction.life <= 0) {
                    distractions.splice(index, 1);
                }
            });
            
            // íŒŒí‹°í´ ì—…ë°ì´íŠ¸
            particles.forEach((particle, index) => {
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.vx *= 0.95;
                particle.vy *= 0.95;
                particle.life--;
                
                if (particle.life <= 0) {
                    particles.splice(index, 1);
                }
            });
            
            // ìŠ¤í‚¬ ì¿¨ë‹¤ìš´ ì—…ë°ì´íŠ¸
            Object.keys(skills).forEach(skillName => {
                if (skills[skillName].cooldown > 0) {
                    skills[skillName].cooldown--;
                }
            });
            
            // ê²½ê³  ë ˆë²¨ ì—…ë°ì´íŠ¸
            if (gameState.stealthLevel > 70) {
                gameState.alertLevel = 0;
            } else if (gameState.stealthLevel > 30) {
                gameState.alertLevel = 1;
            } else {
                gameState.alertLevel = 2;
            }
            
            // ìŠ¹ë¦¬ ì¡°ê±´
            if (gameState.objectives >= 3) {
                gameState.gameRunning = false;
                clearInterval(gameState.timer);
                setTimeout(() => {
                    alert(`ğŸ‰ ë¯¸ì…˜ ì™„ë£Œ!\në°œê° íšŸìˆ˜: ${gameState.detections}íšŒ\nìµœì¢… ì ìˆ˜: ${gameState.score}ì `);
                }, 500);
            }
            
            // ê²Œì„ ì˜¤ë²„ (ì‹œê°„ ì´ˆê³¼)
            if (gameState.timeLeft <= 0) {
                gameState.gameRunning = false;
                clearInterval(gameState.timer);
                setTimeout(() => {
                    alert(`â° ì‹œê°„ ì´ˆê³¼!\nìˆ˜ì§‘í•œ ë³´ë¬¼: ${gameState.objectives}/3\nìµœì¢… ì ìˆ˜: ${gameState.score}ì `);
                }, 500);
            }
            
            updateUI();
        }
        
        // ë Œë”ë§
        function render() {
            // ë°°ê²½
            ctx.fillStyle = '#0E1621';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ê·¸ë¦¼ì ì˜ì—­
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            shadows.forEach(shadow => {
                ctx.fillRect(shadow.x, shadow.y, shadow.width, shadow.height);
            });
            
            // ì—°ë§‰
            smokeClouds.forEach(smoke => {
                const alpha = smoke.life / smoke.maxLife * 0.7;
                ctx.globalAlpha = alpha;
                ctx.fillStyle = '#95A5A6';
                ctx.beginPath();
                ctx.arc(smoke.x, smoke.y, smoke.radius, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
            
            // ì£¼ì˜ë¶„ì‚°
            distractions.forEach(distraction => {
                const alpha = distraction.life / distraction.maxLife;
                ctx.globalAlpha = alpha;
                ctx.fillStyle = '#F39C12';
                ctx.beginPath();
                ctx.arc(distraction.x, distraction.y, 10, 0, Math.PI * 2);
                ctx.fill();
                
                // íŒŒì¥ íš¨ê³¼
                ctx.strokeStyle = '#F39C12';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(distraction.x, distraction.y, 20 * (1 - alpha), 0, Math.PI * 2);
                ctx.stroke();
            });
            ctx.globalAlpha = 1;
            
            // ê²½ë¹„ë“¤
            guards.forEach(guard => {
                // ì‹œì•¼ ê·¸ë¦¬ê¸°
                ctx.fillStyle = `rgba(231, 76, 60, ${0.1 + guard.alertness / guard.maxAlertness * 0.2})`;
                ctx.beginPath();
                ctx.moveTo(guard.x + guard.width/2, guard.y + guard.height/2);
                ctx.arc(
                    guard.x + guard.width/2, 
                    guard.y + guard.height/2, 
                    guard.viewDistance,
                    guard.viewAngle - guard.viewWidth/2,
                    guard.viewAngle + guard.viewWidth/2
                );
                ctx.closePath();
                ctx.fill();
                
                // ê²½ë¹„ ëª¸ì²´
                ctx.fillStyle = guard.alertness > 50 ? '#E74C3C' : '#34495E';
                ctx.fillRect(guard.x, guard.y, guard.width, guard.height);
                
                // ê²½ë¹„ ë°©í–¥ í‘œì‹œ
                const dirX = guard.x + guard.width/2 + Math.cos(guard.viewAngle) * 15;
                const dirY = guard.y + guard.height/2 + Math.sin(guard.viewAngle) * 15;
                ctx.strokeStyle = '#FFFFFF';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(guard.x + guard.width/2, guard.y + guard.height/2);
                ctx.lineTo(dirX, dirY);
                ctx.stroke();
                
                // ê²½ê³„ ìƒíƒœ í‘œì‹œ
                if (guard.alertness > 0) {
                    ctx.fillStyle = '#F39C12';
                    ctx.beginPath();
                    ctx.arc(guard.x + guard.width/2, guard.y - 10, 5, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
            
            // ë³´ë¬¼ë“¤
            treasures.forEach(treasure => {
                if (!treasure.collected) {
                    ctx.fillStyle = '#F1C40F';
                    ctx.fillRect(treasure.x, treasure.y, treasure.width, treasure.height);
                    
                    // ë°˜ì§ì„ íš¨ê³¼
                    ctx.fillStyle = `rgba(241, 196, 15, ${0.5 + Math.sin(Date.now() * 0.01) * 0.3})`;
                    ctx.fillRect(treasure.x - 2, treasure.y - 2, treasure.width + 4, treasure.height + 4);
                }
            });
            
            // ë‹Œì
            if (!ninja.isInvisible) {
                ctx.globalAlpha = ninja.isHidden ? 0.3 : 1;
                ctx.fillStyle = ninja.isHidden ? '#3498DB' : '#2C3E50';
                ctx.fillRect(ninja.x, ninja.y, ninja.width, ninja.height);
                
                // ë‹Œì ëˆˆ
                ctx.fillStyle = '#E74C3C';
                ctx.fillRect(ninja.x + 2, ninja.y + 2, 3, 2);
                ctx.fillRect(ninja.x + ninja.width - 5, ninja.y + 2, 3, 2);
            } else {
                // íˆ¬ëª…í™” ìƒíƒœ - í¬ë¯¸í•œ ìœ¤ê³½
                ctx.globalAlpha = 0.2;
                ctx.strokeStyle = '#9B59B6';
                ctx.lineWidth = 2;
                ctx.strokeRect(ninja.x, ninja.y, ninja.width, ninja.height);
            }
            ctx.globalAlpha = 1;
            
            // íŒŒí‹°í´
            particles.forEach(particle => {
                const alpha = particle.life / particle.maxLife;
                ctx.globalAlpha = alpha;
                ctx.fillStyle = particle.color;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
        }
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            document.getElementById('objectives').textContent = gameState.objectives;
            document.getElementById('detections').textContent = gameState.detections;
            document.getElementById('score').textContent = gameState.score;
            
            // íƒ€ì´ë¨¸
            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // ìŠ¤í…”ìŠ¤ ë¯¸í„°
            document.getElementById('stealthFill').style.width = gameState.stealthLevel + '%';
            
            // ê²½ê³  ë ˆë²¨
            const alertElement = document.getElementById('alertLevel');
            switch(gameState.alertLevel) {
                case 0:
                    alertElement.textContent = 'ğŸŸ¢ ì•ˆì „ ìƒíƒœ';
                    alertElement.className = 'alert-level safe';
                    break;
                case 1:
                    alertElement.textContent = 'ğŸŸ¡ ì£¼ì˜ ìƒíƒœ';
                    alertElement.className = 'alert-level caution';
                    break;
                case 2:
                    alertElement.textContent = 'ğŸ”´ ìœ„í—˜ ìƒíƒœ';
                    alertElement.className = 'alert-level danger';
                    break;
            }
            
            // ìŠ¤í‚¬ ë²„íŠ¼ ìƒíƒœ
            document.getElementById('smokeBtn').disabled = skills.smoke.cooldown > 0;
            document.getElementById('teleportBtn').disabled = skills.teleport.cooldown > 0;
            document.getElementById('invisibleBtn').disabled = skills.invisible.cooldown > 0;
            document.getElementById('distractionBtn').disabled = skills.distraction.cooldown > 0;
        }
        
        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            gameState.timer = setInterval(() => {
                if (gameState.gameRunning) {
                    gameState.timeLeft--;
                }
            }, 1000);
        }
        
        // ê²Œì„ ë£¨í”„
        function gameLoop() {
            update();
            render();
            requestAnimationFrame(gameLoop);
        }
        
        // ê²Œì„ ì‹œì‘
        createLevel();
        startTimer();
        gameLoop();
    </script>
</body>
</html>